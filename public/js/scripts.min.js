"use strict";$(function(){var e=$(".wrapper"),s=$(".header-bottom .wrapper-inner"),t=$(".header-nav"),i=$(".header .contacts"),a=$(".header .address-hours"),n=$(".header-search"),o=$(".header-cart"),l=$(".footer-subscribe"),c=$(".footer-copyrights"),r=$(".footer-social"),d=$(".chooser");function h(){$(window).width()<768?(n.insertBefore(o),i.appendTo(t),a.appendTo(t),l.insertAfter(c)):($(window).width()<1200?(n.insertBefore(o),i.appendTo(s),a.appendTo(t)):(n.removeClass("active"),$(".header").removeClass("menu-opened"),n.appendTo(s),i.appendTo(s),a.appendTo(s)),l.insertBefore(r))}setTimeout(function(){e.animate({opacity:1},500)},500),h(),$(window).on("resize",function(){h()}),$("[data-removable-close]").on("click",function(){$(this).parents("[data-removable]").fadeOut(400,function(){$(this).detach()})}),$('.header-search button[type="submit"]').on("click",function(e){e.preventDefault();var s=$(this).parents(".header-search");$(window).width()<1200?s.hasClass("active")?s.submit():s.addClass("active"):s.submit()}),$(".field-rate-list i").on("click",function(){var t=$(this).index()+1;$(this).parents(".field-rate").find('input[type="hidden"]').val(t),$(this).parents(".field-rate-list").find("i").each(function(e,s){t<=e?$(s).removeClass("fa-red").addClass("fa-grey"):$(s).removeClass("fa-grey").addClass("fa-red")})}),$('.field-file input[type="file"]').on("change",function(){var e=$(this).val().split("\\");$(this).siblings(".field-file-text").text(e[e.length-1])}),$('input[type="tel"]').mask("+7 (999) 999-999-99"),$(".header-burger").on("click",function(){$(this).parents(".header").toggleClass("menu-opened")}),$(".catalog-burger").on("click",function(){$(this).toggleClass("active"),$(this).siblings(".catalog-filter").toggleClass("active")}),$("[data-select-control]").on("click",function(){$(this).parents("[data-select]").hasClass("active")?$(this).parents("[data-select]").removeClass("active"):($("[data-select]").removeClass("active"),$(this).parents("[data-select]").addClass("active"))}),$("[data-select] ul li").on("click",function(){if(!$(this).hasClass("active")){var e=$(this).html(),s=$(this).find(".color-item").length?$(this).find(".color-item-name").text():$(this).text();$(this).addClass("active"),$(this).siblings(".active").removeClass("active"),$(this).parents("[data-select]").find("[data-select-control]").html(e),$(this).parents("[data-select]").find("input").val(s),$(this).parents("[data-select]").removeClass("active")}}),$(".amount-chooser-control").on("click",function(){var e=$(this).siblings("input"),s=parseInt(e.val());$(this).hasClass("amount-chooser-minus")?1<s&&e.val(s-1):$(this).hasClass("amount-chooser-plus")&&e.val(s+1),e.trigger("change")}),$(".amount-chooser input").on("change",function(){var e=$(this).parents(".amount-chooser").siblings(".card-cost").children(".card-cost-value"),s=parseInt($(this).val()),t=parseInt($(this).parents(".amount-chooser").attr("data-cost"));e.text(s*t+" руб.")}),d.find(".chooser-value").on("click",function(){$(this).parents(".chooser").toggleClass("active")}),d.find("ul li").on("click",function(){if(!$(this).hasClass("active")){var e=$(this).text();$(this).siblings().removeClass("active"),$(this).addClass("active"),$(this).parents(".chooser").find(".chooser-value").text(e),$(this).parents(".chooser").removeClass("active")}}),$(document).on("click",function(e){var s=$(e.target);0===s.closest("[data-select]").length&&$(".active[data-select]").removeClass("active"),0===s.closest(".header-search").length&&$(".header-search").removeClass("active"),0===s.closest(".chooser").length&&d.removeClass("active")})}),$(function(){var e=$(".advantages ul");function s(){$(window).width()<768?e.hasClass("slick-slider")||e.slick({infinite:!1}):e.hasClass("slick-slider")&&e.slick("unslick")}e.length&&s(),$(window).on("resize",function(){e.length&&s()})}),$(function(){var e=$(".hero");e.length&&e.slick({dots:!0,arrows:!1,fade:!0,autoplay:!0,autoplaySpeed:5e3})}),$(function(){var e=$(".certificates-list, .product-list, .articles-list, .reviews-list");e.length&&(e.each(function(){$(this).hasClass("product-list")||$(this).hasClass("certificates-list")?$(this).slick({slidesToShow:4,infinite:!1,responsive:[{breakpoint:1200,settings:{slidesToShow:3,infinite:!1}},{breakpoint:930,settings:{slidesToShow:2,infinite:!1}},{breakpoint:768,settings:{infinite:!0,slidesToShow:1}}]}):$(this).slick({slidesToShow:2,vertical:!1,infinite:!1,responsive:[{breakpoint:1200,settings:{slidesToShow:2,infinite:!1,vertical:!0}},{breakpoint:768,settings:{slidesToShow:1,infinite:!0,vertical:!1}}]}),$(this).find(".slick-prev").addClass("disabled")}),e.on("beforeChange",function(e,s,t,i){!function(e,s){var t=$(e).find(".slick-prev"),i=$(e).find(".slick-next"),a=$(e).find(".slick-slide").length,n=$(e).find(".slick-slide.slick-active").length,o=n+1===a;0===s?(t.addClass("disabled"),i.removeClass("disabled")):t.removeClass("disabled");o?a<=s+n?(i.addClass("disabled"),t.removeClass("disabled")):i.removeClass("disabled"):a-1<s+n?(i.addClass("disabled"),t.removeClass("disabled")):i.removeClass("disabled")}($(this),i)}))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJhZHZhbnRhZ2VzLmpzIiwiaGVyby5qcyIsInNsaWRlcnMuanMiXSwibmFtZXMiOlsiJCIsIndyYXBwZXIiLCJoZWFkZXJCb3R0b20iLCJoZWFkZXJOYXYiLCJoZWFkZXJDb250YWN0cyIsImhlYWRlckFkZHJlc3MiLCJoZWFkZXJTZWFyY2giLCJoZWFkZXJDYXJ0IiwiZm9vdGVyU3Vic2NyaWJlIiwiZm9vdGVyQ29weXJpZ2h0cyIsImZvb3RlclNvY2lhbCIsImNob29zZXIiLCJwYWdlUmVwYWludCIsIndpbmRvdyIsIndpZHRoIiwiaW5zZXJ0QmVmb3JlIiwiYXBwZW5kVG8iLCJpbnNlcnRBZnRlciIsInJlbW92ZUNsYXNzIiwic2V0VGltZW91dCIsImFuaW1hdGUiLCJvcGFjaXR5Iiwib24iLCJ0aGlzIiwicGFyZW50cyIsImZhZGVPdXQiLCJkZXRhY2giLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiZm9ybSIsImhhc0NsYXNzIiwic3VibWl0IiwiYWRkQ2xhc3MiLCJ2YWx1ZSIsImluZGV4IiwiZmluZCIsInZhbCIsImVhY2giLCJlbGVtZW50IiwidmFsQXJyYXkiLCJzcGxpdCIsInNpYmxpbmdzIiwidGV4dCIsImxlbmd0aCIsIm1hc2siLCJ0b2dnbGVDbGFzcyIsImh0bWwiLCJ2YWx1ZVRleHQiLCJhbW91bnRET00iLCJhbW91bnRWYWx1ZSIsInBhcnNlSW50IiwidHJpZ2dlciIsImNvc3RET00iLCJjaGlsZHJlbiIsImFtb3VudCIsIml0ZW1Db3N0IiwiYXR0ciIsImRvY3VtZW50IiwidGFyZ2V0IiwiY2xvc2VzdCIsImFkdmFudGFnZXMiLCJyZXBhaW50QWR2YW50YWdlcyIsInNsaWNrIiwiaW5maW5pdGUiLCJoZXJvIiwiZG90cyIsImFycm93cyIsImZhZGUiLCJhdXRvcGxheSIsImF1dG9wbGF5U3BlZWQiLCJzbGlkZXJzIiwic2xpZGVzVG9TaG93IiwicmVzcG9uc2l2ZSIsImJyZWFrcG9pbnQiLCJzZXR0aW5ncyIsInZlcnRpY2FsIiwiY3VycmVudFNsaWRlIiwibmV4dFNsaWRlIiwic2xpZGVyIiwicHJldiIsIm5leHQiLCJzaXplIiwidmlzaWJsZSIsInNtYWxsQW1vdW50Iiwic2V0U2xpZGVyQXJyb3dzIl0sIm1hcHBpbmdzIjoiYUFBQUEsRUFBRSxXQUVBLElBQU1DLEVBQVVELEVBQUUsWUFDWkUsRUFBZUYsRUFBRSxpQ0FDakJHLEVBQVlILEVBQUUsZUFDZEksRUFBaUJKLEVBQUUscUJBQ25CSyxFQUFnQkwsRUFBRSwwQkFDbEJNLEVBQWVOLEVBQUUsa0JBQ2pCTyxFQUFhUCxFQUFFLGdCQUNmUSxFQUFrQlIsRUFBRSxxQkFDcEJTLEVBQW1CVCxFQUFFLHNCQUNyQlUsRUFBZVYsRUFBRSxrQkFDakJXLEVBQVVYLEVBQUUsWUErSGxCLFNBQVNZLElBQ0haLEVBQUVhLFFBQVFDLFFBQVUsS0FleEJSLEVBQWFTLGFBQWFSLEdBQzFCSCxFQUFlWSxTQUFTYixHQUN4QkUsRUFBY1csU0FBU2IsR0FnQnZCSyxFQUFnQlMsWUFBWVIsS0E5QmpCVCxFQUFFYSxRQUFRQyxRQUFVLE1Ba0IvQlIsRUFBYVMsYUFBYVIsR0FDMUJILEVBQWVZLFNBQVNkLEdBQ3hCRyxFQUFjVyxTQUFTYixLQWhCckJHLEVBQWFZLFlBQVksVUFDekJsQixFQUFFLFdBQVdrQixZQUFZLGVBbUIzQlosRUFBYVUsU0FBU2QsR0FDdEJFLEVBQWVZLFNBQVNkLEdBQ3hCRyxFQUFjVyxTQUFTZCxJQVF2Qk0sRUFBZ0JPLGFBQWFMLElBbksvQlMsV0FBVyxXQUNUbEIsRUFBUW1CLFFBQVEsQ0FBQ0MsUUFBUyxHQUFJLE1BQzdCLEtBRUhULElBRUFaLEVBQUVhLFFBQVFTLEdBQUcsU0FBVSxXQUNyQlYsTUFHRlosRUFBRSwwQkFBMEJzQixHQUFHLFFBQVMsV0FDdEN0QixFQUFFdUIsTUFBTUMsUUFBUSxvQkFDYkMsUUFBUSxJQUFLLFdBQ1p6QixFQUFFdUIsTUFBTUcsYUFJZDFCLEVBQUUsd0NBQXdDc0IsR0FBRyxRQUFTLFNBQVVLLEdBQzlEQSxFQUFNQyxp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ZCtDLEVBQUs3RCxZQUFZLGFBRWpCOEQsRUFBSzlELFlBQVksWUFHTytELEVBQU8sRUFBN0JKLEVBQVlLLEdBQ2RGLEVBQUtoRCxTQUFTLFlBQ2QrQyxFQUFLN0QsWUFBWSxhQUVqQjhELEVBQUs5RCxZQUFZLFlBN0JuQmtFLENBQWdCcEYsRUFBRXVCLE1BQU9zRCIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoZnVuY3Rpb24gKCkge1xyXG5cclxuICBjb25zdCB3cmFwcGVyID0gJCgnLndyYXBwZXInKTtcclxuICBjb25zdCBoZWFkZXJCb3R0b20gPSAkKCcuaGVhZGVyLWJvdHRvbSAud3JhcHBlci1pbm5lcicpO1xyXG4gIGNvbnN0IGhlYWRlck5hdiA9ICQoJy5oZWFkZXItbmF2Jyk7XHJcbiAgY29uc3QgaGVhZGVyQ29udGFjdHMgPSAkKCcuaGVhZGVyIC5jb250YWN0cycpO1xyXG4gIGNvbnN0IGhlYWRlckFkZHJlc3MgPSAkKCcuaGVhZGVyIC5hZGRyZXNzLWhvdXJzJyk7XHJcbiAgY29uc3QgaGVhZGVyU2VhcmNoID0gJCgnLmhlYWRlci1zZWFyY2gnKTtcclxuICBjb25zdCBoZWFkZXJDYXJ0ID0gJCgnLmhlYWRlci1jYXJ0Jyk7XHJcbiAgY29uc3QgZm9vdGVyU3Vic2NyaWJlID0gJCgnLmZvb3Rlci1zdWJzY3JpYmUnKTtcclxuICBjb25zdCBmb290ZXJDb3B5cmlnaHRzID0gJCgnLmZvb3Rlci1jb3B5cmlnaHRzJyk7XHJcbiAgY29uc3QgZm9vdGVyU29jaWFsID0gJCgnLmZvb3Rlci1zb2NpYWwnKTtcclxuICBjb25zdCBjaG9vc2VyID0gJCgnLmNob29zZXInKTtcclxuXHJcbiAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICB3cmFwcGVyLmFuaW1hdGUoe29wYWNpdHk6IDF9LCA1MDApO1xyXG4gIH0sIDUwMCk7XHJcblxyXG4gIHBhZ2VSZXBhaW50KCk7XHJcblxyXG4gICQod2luZG93KS5vbigncmVzaXplJywgZnVuY3Rpb24gKCkge1xyXG4gICAgcGFnZVJlcGFpbnQoKTtcclxuICB9KTtcclxuXHJcbiAgJCgnW2RhdGEtcmVtb3ZhYmxlLWNsb3NlXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICQodGhpcykucGFyZW50cygnW2RhdGEtcmVtb3ZhYmxlXScpXHJcbiAgICAgIC5mYWRlT3V0KDQwMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQodGhpcykuZGV0YWNoKCk7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAkKCcuaGVhZGVyLXNlYXJjaCBidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGZvcm0gPSAkKHRoaXMpLnBhcmVudHMoJy5oZWFkZXItc2VhcmNoJyk7XHJcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCAxMjAwKSB7XHJcbiAgICAgIGlmIChmb3JtLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xyXG4gICAgICAgIGZvcm0uc3VibWl0KCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZm9ybS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZvcm0uc3VibWl0KCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoJy5maWVsZC1yYXRlLWxpc3QgaScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIGNvbnN0IHZhbHVlID0gJCh0aGlzKS5pbmRleCgpICsgMTtcclxuICAgICQodGhpcykucGFyZW50cygnLmZpZWxkLXJhdGUnKS5maW5kKCdpbnB1dFt0eXBlPVwiaGlkZGVuXCJdJykudmFsKHZhbHVlKTtcclxuICAgICQodGhpcykucGFyZW50cygnLmZpZWxkLXJhdGUtbGlzdCcpLmZpbmQoJ2knKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICBpZiAoaW5kZXggPj0gdmFsdWUpIHtcclxuICAgICAgICAkKGVsZW1lbnQpLnJlbW92ZUNsYXNzKCdmYS1yZWQnKS5hZGRDbGFzcygnZmEtZ3JleScpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoZWxlbWVudCkucmVtb3ZlQ2xhc3MoJ2ZhLWdyZXknKS5hZGRDbGFzcygnZmEtcmVkJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAkKCcuZmllbGQtZmlsZSBpbnB1dFt0eXBlPVwiZmlsZVwiXScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCB2YWxBcnJheSA9ICQodGhpcykudmFsKCkuc3BsaXQoJ1xcXFwnKTtcclxuICAgICQodGhpcykuc2libGluZ3MoJy5maWVsZC1maWxlLXRleHQnKS50ZXh0KHZhbEFycmF5W3ZhbEFycmF5Lmxlbmd0aCAtIDFdKTtcclxuICB9KTtcclxuXHJcbiAgJCgnaW5wdXRbdHlwZT1cInRlbFwiXScpLm1hc2soXCIrNyAoOTk5KSA5OTktOTk5LTk5XCIpO1xyXG5cclxuICAkKCcuaGVhZGVyLWJ1cmdlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICQodGhpcykucGFyZW50cygnLmhlYWRlcicpLnRvZ2dsZUNsYXNzKCdtZW51LW9wZW5lZCcpO1xyXG4gIH0pO1xyXG5cclxuICAkKCcuY2F0YWxvZy1idXJnZXInKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICQodGhpcykuc2libGluZ3MoJy5jYXRhbG9nLWZpbHRlcicpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcclxuICB9KTtcclxuXHJcbiAgJCgnW2RhdGEtc2VsZWN0LWNvbnRyb2xdJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKCQodGhpcykucGFyZW50cygnW2RhdGEtc2VsZWN0XScpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xyXG4gICAgICAkKHRoaXMpLnBhcmVudHMoJ1tkYXRhLXNlbGVjdF0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAkKCdbZGF0YS1zZWxlY3RdJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAkKHRoaXMpLnBhcmVudHMoJ1tkYXRhLXNlbGVjdF0nKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoJ1tkYXRhLXNlbGVjdF0gdWwgbGknKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoISQodGhpcykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gJCh0aGlzKS5odG1sKCk7XHJcbiAgICAgIGNvbnN0IHZhbHVlVGV4dCA9ICgkKHRoaXMpLmZpbmQoJy5jb2xvci1pdGVtJykubGVuZ3RoKVxyXG4gICAgICAgID8gJCh0aGlzKS5maW5kKCcuY29sb3ItaXRlbS1uYW1lJykudGV4dCgpXHJcbiAgICAgICAgOiAkKHRoaXMpLnRleHQoKTtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQodGhpcykuc2libGluZ3MoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQodGhpcykucGFyZW50cygnW2RhdGEtc2VsZWN0XScpLmZpbmQoJ1tkYXRhLXNlbGVjdC1jb250cm9sXScpLmh0bWwodmFsdWUpO1xyXG4gICAgICAkKHRoaXMpLnBhcmVudHMoJ1tkYXRhLXNlbGVjdF0nKS5maW5kKCdpbnB1dCcpLnZhbCh2YWx1ZVRleHQpO1xyXG4gICAgICAkKHRoaXMpLnBhcmVudHMoJ1tkYXRhLXNlbGVjdF0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoJy5hbW91bnQtY2hvb3Nlci1jb250cm9sJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgYW1vdW50RE9NID0gJCh0aGlzKS5zaWJsaW5ncygnaW5wdXQnKTtcclxuICAgIGNvbnN0IGFtb3VudFZhbHVlID0gcGFyc2VJbnQoYW1vdW50RE9NLnZhbCgpKTtcclxuICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdhbW91bnQtY2hvb3Nlci1taW51cycpKSB7XHJcbiAgICAgIGlmIChhbW91bnRWYWx1ZSA+IDEpIHtcclxuICAgICAgICBhbW91bnRET00udmFsKGFtb3VudFZhbHVlIC0gMSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoJCh0aGlzKS5oYXNDbGFzcygnYW1vdW50LWNob29zZXItcGx1cycpKSB7XHJcbiAgICAgIGFtb3VudERPTS52YWwoYW1vdW50VmFsdWUgKyAxKTtcclxuICAgIH1cclxuICAgIGFtb3VudERPTS50cmlnZ2VyKCdjaGFuZ2UnKTtcclxuICB9KTtcclxuXHJcbiAgJCgnLmFtb3VudC1jaG9vc2VyIGlucHV0Jykub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcclxuICAgIGNvbnN0IGNvc3RET00gPSAkKHRoaXMpLnBhcmVudHMoJy5hbW91bnQtY2hvb3NlcicpLnNpYmxpbmdzKCcuY2FyZC1jb3N0JykuY2hpbGRyZW4oJy5jYXJkLWNvc3QtdmFsdWUnKTtcclxuICAgIGNvbnN0IGFtb3VudCA9IHBhcnNlSW50KCQodGhpcykudmFsKCkpO1xyXG4gICAgY29uc3QgaXRlbUNvc3QgPSBwYXJzZUludCgkKHRoaXMpLnBhcmVudHMoJy5hbW91bnQtY2hvb3NlcicpLmF0dHIoJ2RhdGEtY29zdCcpKTtcclxuICAgIGNvc3RET00udGV4dChhbW91bnQgKiBpdGVtQ29zdCArICcg0YDRg9CxLicpO1xyXG4gIH0pO1xyXG5cclxuICBjaG9vc2VyLmZpbmQoJy5jaG9vc2VyLXZhbHVlJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgJCh0aGlzKS5wYXJlbnRzKCcuY2hvb3NlcicpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcclxuICB9KTtcclxuXHJcbiAgY2hvb3Nlci5maW5kKCd1bCBsaScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcclxuICAgICAgY29uc3QgdmFsdWUgPSAkKHRoaXMpLnRleHQoKTtcclxuICAgICAgJCh0aGlzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQodGhpcykucGFyZW50cygnLmNob29zZXInKS5maW5kKCcuY2hvb3Nlci12YWx1ZScpLnRleHQodmFsdWUpO1xyXG4gICAgICAkKHRoaXMpLnBhcmVudHMoJy5jaG9vc2VyJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKGRvY3VtZW50KS5vbignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9ICQoZXZlbnQudGFyZ2V0KTtcclxuXHJcbiAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLXNlbGVjdF0nKS5sZW5ndGggPT09IDApICQoJy5hY3RpdmVbZGF0YS1zZWxlY3RdJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgaWYgKHRhcmdldC5jbG9zZXN0KCcuaGVhZGVyLXNlYXJjaCcpLmxlbmd0aCA9PT0gMCkgJCgnLmhlYWRlci1zZWFyY2gnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5jaG9vc2VyJykubGVuZ3RoID09PSAwKSBjaG9vc2VyLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIHBhZ2VSZXBhaW50KCkge1xyXG4gICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNzY4KSB7XHJcbiAgICAgIHJlbmRlck1vYmlsZUhlYWRlcigpO1xyXG4gICAgICByZW5kZXJNb2JpbGVGb290ZXIoKTtcclxuICAgIH0gZWxzZSBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCAxMjAwKSB7XHJcbiAgICAgIHJlbmRlclRhYmxldEhlYWRlcigpO1xyXG4gICAgICByZW5kZXJUYWJsZXRGb290ZXIoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGhlYWRlclNlYXJjaC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQoJy5oZWFkZXInKS5yZW1vdmVDbGFzcygnbWVudS1vcGVuZWQnKTtcclxuICAgICAgcmVuZGVyRGVza3RvcEhlYWRlcigpO1xyXG4gICAgICByZW5kZXJEZXNrdG9wRm9vdGVyKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZW5kZXJNb2JpbGVIZWFkZXIoKSB7XHJcbiAgICBoZWFkZXJTZWFyY2guaW5zZXJ0QmVmb3JlKGhlYWRlckNhcnQpO1xyXG4gICAgaGVhZGVyQ29udGFjdHMuYXBwZW5kVG8oaGVhZGVyTmF2KTtcclxuICAgIGhlYWRlckFkZHJlc3MuYXBwZW5kVG8oaGVhZGVyTmF2KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbmRlclRhYmxldEhlYWRlcigpIHtcclxuICAgIGhlYWRlclNlYXJjaC5pbnNlcnRCZWZvcmUoaGVhZGVyQ2FydCk7XHJcbiAgICBoZWFkZXJDb250YWN0cy5hcHBlbmRUbyhoZWFkZXJCb3R0b20pO1xyXG4gICAgaGVhZGVyQWRkcmVzcy5hcHBlbmRUbyhoZWFkZXJOYXYpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmVuZGVyRGVza3RvcEhlYWRlcigpIHtcclxuICAgIGhlYWRlclNlYXJjaC5hcHBlbmRUbyhoZWFkZXJCb3R0b20pO1xyXG4gICAgaGVhZGVyQ29udGFjdHMuYXBwZW5kVG8oaGVhZGVyQm90dG9tKTtcclxuICAgIGhlYWRlckFkZHJlc3MuYXBwZW5kVG8oaGVhZGVyQm90dG9tKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbmRlck1vYmlsZUZvb3RlcigpIHtcclxuICAgIGZvb3RlclN1YnNjcmliZS5pbnNlcnRBZnRlcihmb290ZXJDb3B5cmlnaHRzKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbmRlclRhYmxldEZvb3RlcigpIHtcclxuICAgIGZvb3RlclN1YnNjcmliZS5pbnNlcnRCZWZvcmUoZm9vdGVyU29jaWFsKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbmRlckRlc2t0b3BGb290ZXIoKSB7XHJcbiAgICAgIGZvb3RlclN1YnNjcmliZS5pbnNlcnRCZWZvcmUoZm9vdGVyU29jaWFsKTtcclxuICB9XHJcblxyXG59KTtcclxuIiwiJChmdW5jdGlvbiAoKSB7XHJcblxyXG4gIGNvbnN0IGFkdmFudGFnZXMgPSAkKCcuYWR2YW50YWdlcyB1bCcpO1xyXG5cclxuICBpZiAoYWR2YW50YWdlcy5sZW5ndGgpIHtcclxuICAgIHJlcGFpbnRBZHZhbnRhZ2VzKCk7XHJcbiAgfVxyXG5cclxuICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcclxuICAgIGlmIChhZHZhbnRhZ2VzLmxlbmd0aCkge1xyXG4gICAgICByZXBhaW50QWR2YW50YWdlcygpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiByZXBhaW50QWR2YW50YWdlcyAoKSB7XHJcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCA3NjgpIHtcclxuICAgICAgaWYgKCFhZHZhbnRhZ2VzLmhhc0NsYXNzKCdzbGljay1zbGlkZXInKSkge1xyXG4gICAgICAgIGFkdmFudGFnZXMuc2xpY2soe1xyXG4gICAgICAgICAgaW5maW5pdGU6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmIChhZHZhbnRhZ2VzLmhhc0NsYXNzKCdzbGljay1zbGlkZXInKSkge1xyXG4gICAgICAgIGFkdmFudGFnZXMuc2xpY2soJ3Vuc2xpY2snKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbn0pO1xyXG4iLCIkKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgY29uc3QgaGVybyA9ICQoJy5oZXJvJyk7XHJcblxyXG4gIGlmIChoZXJvLmxlbmd0aCkge1xyXG4gICAgaGVyby5zbGljayh7XHJcbiAgICAgIGRvdHM6IHRydWUsXHJcbiAgICAgIGFycm93czogZmFsc2UsXHJcbiAgICAgIGZhZGU6IHRydWUsXHJcbiAgICAgIGF1dG9wbGF5OiB0cnVlLFxyXG4gICAgICBhdXRvcGxheVNwZWVkOiA1MDAwXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59KTtcclxuIiwiJChmdW5jdGlvbiAoKSB7XHJcblxyXG4gIGNvbnN0IHNsaWRlcnMgPSAkKCcuY2VydGlmaWNhdGVzLWxpc3QsIC5wcm9kdWN0LWxpc3QsIC5hcnRpY2xlcy1saXN0LCAucmV2aWV3cy1saXN0Jyk7XHJcblxyXG4gIGlmIChzbGlkZXJzLmxlbmd0aCkge1xyXG5cclxuICAgIHNsaWRlcnMuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdwcm9kdWN0LWxpc3QnKSB8fCAkKHRoaXMpLmhhc0NsYXNzKCdjZXJ0aWZpY2F0ZXMtbGlzdCcpKSB7XHJcbiAgICAgICAgJCh0aGlzKS5zbGljayh7XHJcbiAgICAgICAgICBzbGlkZXNUb1Nob3c6IDQsXHJcbiAgICAgICAgICBpbmZpbml0ZTogZmFsc2UsXHJcbiAgICAgICAgICByZXNwb25zaXZlOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBicmVha3BvaW50OiAxMjAwLFxyXG4gICAgICAgICAgICAgIHNldHRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDMsXHJcbiAgICAgICAgICAgICAgICBpbmZpbml0ZTogZmFsc2VcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBicmVha3BvaW50OiA5MzAsXHJcbiAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgICAgICAgIHNsaWRlc1RvU2hvdzogMixcclxuICAgICAgICAgICAgICAgIGluZmluaXRlOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDc2OCxcclxuICAgICAgICAgICAgICBzZXR0aW5nczoge1xyXG4gICAgICAgICAgICAgICAgaW5maW5pdGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDFcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIF1cclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnNsaWNrKHtcclxuICAgICAgICAgIHNsaWRlc1RvU2hvdzogMixcclxuICAgICAgICAgIHZlcnRpY2FsOmZhbHNlLFxyXG4gICAgICAgICAgaW5maW5pdGU6IGZhbHNlLFxyXG4gICAgICAgICAgcmVzcG9uc2l2ZTogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgYnJlYWtwb2ludDogMTIwMCxcclxuICAgICAgICAgICAgICBzZXR0aW5nczoge1xyXG4gICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiAyLFxyXG4gICAgICAgICAgICAgICAgaW5maW5pdGU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgdmVydGljYWw6IHRydWVcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBicmVha3BvaW50OiA3NjgsXHJcbiAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgICAgICAgIHNsaWRlc1RvU2hvdzogMSxcclxuICAgICAgICAgICAgICAgIGluZmluaXRlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgdmVydGljYWw6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICBdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgJCh0aGlzKS5maW5kKCcuc2xpY2stcHJldicpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2xpZGVycy5vbignYmVmb3JlQ2hhbmdlJywgZnVuY3Rpb24oZXZlbnQsIHNsaWNrLCBjdXJyZW50U2xpZGUsIG5leHRTbGlkZSkge1xyXG4gICAgICBzZXRTbGlkZXJBcnJvd3MoJCh0aGlzKSwgbmV4dFNsaWRlKTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNldFNsaWRlckFycm93cyAoc2xpZGVyLCBuZXh0U2xpZGUpIHtcclxuICAgIGNvbnN0IHByZXYgPSAkKHNsaWRlcikuZmluZCgnLnNsaWNrLXByZXYnKTtcclxuICAgIGNvbnN0IG5leHQgPSAkKHNsaWRlcikuZmluZCgnLnNsaWNrLW5leHQnKTtcclxuICAgIGNvbnN0IHNpemUgPSAkKHNsaWRlcikuZmluZCgnLnNsaWNrLXNsaWRlJykubGVuZ3RoO1xyXG4gICAgY29uc3QgdmlzaWJsZSA9ICQoc2xpZGVyKS5maW5kKCcuc2xpY2stc2xpZGUuc2xpY2stYWN0aXZlJykubGVuZ3RoO1xyXG4gICAgY29uc3Qgc21hbGxBbW91bnQgPSB2aXNpYmxlICsgMSA9PT0gc2l6ZTtcclxuICAgIGlmIChuZXh0U2xpZGUgPT09IDApIHtcclxuICAgICAgcHJldi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgICAgbmV4dC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHByZXYucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICB9XHJcbiAgICBpZiAoc21hbGxBbW91bnQpIHtcclxuICAgICAgaWYgKG5leHRTbGlkZSArIHZpc2libGUgPj0gc2l6ZSkge1xyXG4gICAgICAgIG5leHQuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICAgICAgcHJldi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBuZXh0LnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAobmV4dFNsaWRlICsgdmlzaWJsZSA+IHNpemUgLSAxKSB7XHJcbiAgICAgICAgbmV4dC5hZGRDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgICAgICBwcmV2LnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG5leHQucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG59KTtcclxuIl19
