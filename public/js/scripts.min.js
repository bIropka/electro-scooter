"use strict";$(function(){var e=$(".wrapper"),t=$("body"),s=$(".header-bottom .wrapper-inner"),i=$(".header-nav"),a=$(".header .contacts"),n=$(".header .address-hours"),o=$(".header-search"),l=$(".header-cart"),r=$(".footer-subscribe"),c=$(".footer-copyrights"),d=$(".footer-social"),h=$(".chooser"),p=$(".chooser.chooser-color");function f(){$(window).width()<768?(o.insertBefore(l),a.appendTo(i),n.appendTo(i),r.insertAfter(c)):($(window).width()<1200?(o.insertBefore(l),a.appendTo(s),n.appendTo(i)):(o.removeClass("active"),$(".header").removeClass("menu-opened"),o.appendTo(s),a.appendTo(s),n.appendTo(s)),r.insertBefore(d))}setTimeout(function(){e.animate({opacity:1},500)},500),f(),$(window).on("resize",function(){f()}),$("[data-removable-close]").on("click",function(){$(this).parents("[data-removable]").fadeOut(400,function(){$(this).detach()})}),$('.header-search button[type="submit"]').on("click",function(e){e.preventDefault();var s=$(this).parents(".header-search");$(window).width()<1200?s.hasClass("active")?s.submit():s.addClass("active"):s.submit()}),$(".field-rate-list i").on("click",function(){var t=$(this).index()+1;$(this).parents(".field-rate").find('input[type="hidden"]').val(t),$(this).parents(".field-rate-list").find("i").each(function(e,s){t<=e?$(s).removeClass("fa-red").addClass("fa-grey"):$(s).removeClass("fa-grey").addClass("fa-red")})}),$('.field-file input[type="file"]').on("change",function(){var e=$(this).val().split("\\");$(this).siblings(".field-file-text").text(e[e.length-1])}),$('input[type="tel"]').mask("+7 (999) 999-999-99"),$(".header-burger").on("click",function(){$(this).parents(".header").toggleClass("menu-opened")}),$("[data-call-modal]").on("click",function(){var e=$(this).attr("data-call-modal"),s=$(window).scrollTop();t.addClass("modal-opened"),$('[data-modal="'.concat(e,'"]')).fadeIn(300).css({display:"flex",top:"".concat(s,"px")})}),$(".modal").on("click",function(e){var s=$(e.target);!s.hasClass("modal-close")&&s.closest(".modal-inner").length||($(this).fadeOut(300),t.removeClass("modal-opened"))}),$("[data-select-control]").on("click",function(){$(this).parents("[data-select]").hasClass("active")?$(this).parents("[data-select]").removeClass("active"):($("[data-select]").removeClass("active"),$(this).parents("[data-select]").addClass("active"))}),$("[data-select] ul li").on("click",function(){if(!$(this).hasClass("active")){var e=$(this).text();$(this).addClass("active"),$(this).siblings(".active").removeClass("active"),$(this).parents("ul").siblings("[data-select-control]").text(e),$(this).parents("ul").siblings("input").val(e),$(this).parents("[data-select]").removeClass("active")}}),$(".amount-chooser-control").on("click",function(){var e=$(this).siblings("input"),s=parseInt(e.val());$(this).hasClass("amount-chooser-minus")?1<s&&e.val(s-1):$(this).hasClass("amount-chooser-plus")&&e.val(s+1),e.trigger("change")}),$(".amount-chooser input").on("change",function(){var e=$(this).parents(".amount-chooser").siblings(".card-cost").children(".card-cost-value"),s=parseInt($(this).val()),t=parseInt($(this).parents(".amount-chooser").attr("data-cost"));e.text(s*t+" руб.")}),h.find(".chooser-value").on("click",function(){if($(this).closest(".catalog-brands").length||$(this).closest(".chooser-color").length&&767<$(window).width())return!1;$(this).parents(".chooser").toggleClass("active")}),h.find("ul li").on("click",function(){if(!$(this).hasClass("active")){var e=$(this).html();$(this).siblings().removeClass("active"),$(this).addClass("active"),$(this).parents(".chooser").removeClass("active"),$(this).closest(".chooser-color").length?($(window).width()<768&&$(this).parents("ul").siblings(".chooser-value").html(e),$(this).parents("ul").siblings("input").val($(this).find(".chooser-color-text").text())):($(this).parents("ul").siblings(".chooser-value").html(e),$(this).parents("ul").siblings("input").val(e))}}),p.find("ul li").on("click",function(e){if(e.preventDefault(),!$(this).hasClass("active")){var s=$(this).find(".chooser-color-text").text();$(this).parents("ul").siblings("input").val(s)}}),$(document).on("click",function(e){var s=$(e.target);0===s.closest("[data-select]").length&&$(".active[data-select]").removeClass("active"),0===s.closest(".header-search").length&&$(".header-search").removeClass("active"),0===s.closest(".chooser").length&&h.removeClass("active")})}),$(function(){var e=$("body"),s=$(".catalog-filter"),t=$(".catalog-articles"),i=$(".catalog-banner"),a=$(".breadcrumbs"),n=$(".catalog-aside"),o=document.getElementById("filter-cost"),l=[document.getElementById("filter-cost-from"),document.getElementById("filter-cost-to")];function r(){$(window).width()<1200?function(){a.prependTo($(".header").next(".wrapper-inner")),0===s.find(".modal-close").length&&$('<div class="modal-close"></div>').prependTo(s);s.appendTo('.modal[data-modal="filter"]'),t.insertAfter(".pagination"),i.insertAfter(t)}():function(){a.prependTo($(".catalog-content")),e.removeClass("modal-opened"),$('.modal[data-modal="filter"]').css({display:"none",top:"auto"}),s.find(".modal-close").length&&$(s.find(".modal-close")).detach();s.prependTo(n),t.appendTo(n),i.appendTo(n)}()}r(),o&&(noUiSlider.create(o,{start:[1e3,5e3],step:100,margin:1e3,connect:!0,range:{min:0,max:8e3}}),l.forEach(function(e,s){e.addEventListener("change",function(){o.noUiSlider.setHandle(s,l[s].value)})}),o.noUiSlider.on("update",function(e,s){l[s].value=Math.trunc(e[s])})),$(window).on("resize",function(){r()})}),$(function(){var e=$(".hero");e.length&&e.slick({dots:!0,arrows:!1,fade:!0,autoplay:!0,autoplaySpeed:5e3})}),$(function(){var e=$(".item-image-large"),s=$(".item-image-small"),t=$(".item-params"),i=$(".chooser.chooser-color ul"),a=$(".item .item-list"),n=$(".item-image"),o=$(".item-form-header"),l=$(".item-delivery"),r=$(".item-form");function c(e){$(window).width()<768?$(e).each(function(){$(this).hasClass("slick-slider")&&$(this).slick("unslick")}):$(e).each(function(){$(this).hasClass("slick-slider")||$(this).slick({slidesToShow:3,infinite:!1})})}function d(){$(window).width()<768?(a.insertAfter(o),l.insertAfter(r)):$(window).width()<1200?(a.appendTo(n),l.insertAfter(r)):(a.appendTo(n),l.appendTo(r))}d(),c(i),t.length&&t.slick({slidesToShow:3,responsive:[{breakpoint:1200,settings:{slidesToShow:4}},{breakpoint:768,settings:{slidesToShow:2}}]}),e.length&&s.length&&(e.slick({arrows:!1,fade:!0,asNavFor:".item-image-small"}),s.slick({slidesToShow:4,focusOnSelect:!0,asNavFor:".item-image-large",responsive:[{breakpoint:1200,settings:{slidesToShow:2}}]})),$(window).on("resize",function(){c(i),d()})}),$(function(){var e=$(".advantages ul, .reviews-rate");function s(e){$(window).width()<768?$(e).each(function(){$(this).hasClass("slick-slider")||$(this).slick()}):$(e).each(function(){$(this).hasClass("slick-slider")&&$(this).slick("unslick")})}s(e),$(window).on("resize",function(){s(e)})}),$(function(){$(".reviews-result-percent").each(function(){var e=parseInt($(this).attr("data-result-percent")),s=$(this).find(".reviews-result-percent-value");$('<div class="reviews-result-percent-color"></div>').appendTo(s).css("width",e+"%")}),$(".reviews-list .reviews-card p .show-all").on("click",function(){$(this).siblings(".all-text").css("display","inline"),$(this).siblings(".dots").css("display","none"),$(this).css("display","none")})}),$(function(){var e=$(".certificates-list, .product-list, .articles-list, .reviews-slider");e.length&&(e.each(function(){$(this).hasClass("product-list")||$(this).hasClass("certificates-list")?$(this).slick({slidesToShow:4,infinite:!1,responsive:[{breakpoint:1200,settings:{slidesToShow:3,infinite:!1}},{breakpoint:930,settings:{slidesToShow:2,infinite:!1}},{breakpoint:768,settings:{infinite:!0,slidesToShow:1}}]}):$(this).slick({slidesToShow:2,vertical:!1,infinite:!1,responsive:[{breakpoint:1200,settings:{slidesToShow:2,infinite:!1,vertical:!0}},{breakpoint:768,settings:{slidesToShow:1,infinite:!0,vertical:!1}}]}),$(this).find(".slick-prev").addClass("disabled")}),e.on("beforeChange",function(e,s,t,i){!function(e,s){var t=$(e).find(".slick-prev"),i=$(e).find(".slick-next"),a=$(e).find(".slick-slide").length,n=$(e).find(".slick-slide.slick-active").length,o=n+1===a;0===s?(t.addClass("disabled"),i.removeClass("disabled")):t.removeClass("disabled");o?a<=s+n?(i.addClass("disabled"),t.removeClass("disabled")):i.removeClass("disabled"):a-1<s+n?(i.addClass("disabled"),t.removeClass("disabled")):i.removeClass("disabled")}($(this),i)}))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjYXRhbG9nLmpzIiwiaGVyby5qcyIsIml0ZW0uanMiLCJtb2JpbGVTbGlkZXIuanMiLCJyZXZpZXdzLmpzIiwic2xpZGVycy5qcyJdLCJuYW1lcyI6WyIkIiwid3JhcHBlciIsImJvZHkiLCJoZWFkZXJCb3R0b20iLCJoZWFkZXJOYXYiLCJoZWFkZXJDb250YWN0cyIsImhlYWRlckFkZHJlc3MiLCJoZWFkZXJTZWFyY2giLCJoZWFkZXJDYXJ0IiwiZm9vdGVyU3Vic2NyaWJlIiwiZm9vdGVyQ29weXJpZ2h0cyIsImZvb3RlclNvY2lhbCIsImNob29zZXIiLCJjaG9vc2VyQ29sb3IiLCJwYWdlUmVwYWludCIsIndpbmRvdyIsIndpZHRoIiwiaW5zZXJ0QmVmb3JlIiwiYXBwZW5kVG8iLCJpbnNlcnRBZnRlciIsInJlbW92ZUNsYXNzIiwic2V0VGltZW91dCIsImFuaW1hdGUiLCJvcGFjaXR5Iiwib24iLCJ0aGlzIiwicGFyZW50cyIsImZhZGVPdXQiLCJkZXRhY2giLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiZm9ybSIsImhhc0NsYXNzIiwic3VibWl0IiwiYWRkQ2xhc3MiLCJ2YWx1ZSIsImluZGV4IiwiZmluZCIsInZhbCIsImVhY2giLCJlbGVtZW50IiwidmFsQXJyYXkiLCJzcGxpdCIsInNpYmxpbmdzIiwidGV4dCIsImxlbmd0aCIsIm1hc2siLCJ0b2dnbGVDbGFzcyIsInRhcmdldCIsImF0dHIiLCJzY3JvbGxWYWx1ZSIsInNjcm9sbFRvcCIsImNvbmNhdCIsImZhZGVJbiIsImNzcyIsImRpc3BsYXkiLCJ0b3AiLCJjbG9zZXN0IiwiYW1vdW50RE9NIiwiYW1vdW50VmFsdWUiLCJwYXJzZUludCIsInRyaWdnZXIiLCJjb3N0RE9NIiwiY2hpbGRyZW4iLCJhbW91bnQiLCJpdGVtQ29zdCIsImh0bWwiLCJkb2N1bWVudCIsImNhdGFsb2dGaWx0ZXIiLCJjYXRhbG9nQXJ0aWNsZXMiLCJjYXRhbG9nQmFubmVyIiwiYnJlYWRjcnVtYnMiLCJjYXRhbG9nQXNpZGUiLCJmaWx0ZXJDb3N0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmaWx0ZXJDb3N0SGFuZGxlcyIsImNhdGFsb2dSZXBhaW50IiwicHJlcGVuZFRvIiwibmV4dCIsInJlbmRlck1vYmlsZUNhdGFsb2ciLCJyZW5kZXJEZXNrdG9wQ2F0YWxvZyIsIm5vVWlTbGlkZXIiLCJjcmVhdGUiLCJzdGFydCIsInN0ZXAiLCJtYXJnaW4iLCJjb25uZWN0IiwicmFuZ2UiLCJtaW4iLCJtYXgiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNldEhhbmRsZSIsInZhbHVlcyIsImhhbmRsZSIsIk1hdGgiLCJ0cnVuYyIsImhlcm8iLCJzbGljayIsImRvdHMiLCJhcnJvd3MiLCJmYWRlIiwiYXV0b3BsYXkiLCJhdXRvcGxheVNwZWVkIiwiaXRlbVNsaWRlckxhcmdlIiwiaXRlbVNsaWRlclNtYWxsIiwicGFyYW1zIiwiY29sb3JTbGlkZXIiLCJpdGVtTGlzdCIsIml0ZW1JbWFnZSIsIml0ZW1Gb3JtSGVhZGVyIiwiaXRlbURlbGl2ZXJ5IiwiaXRlbUZvcm0iLCJyZXBhaW50Q29sb3JTbGlkZXIiLCJzbGlkZXNUb1Nob3ciLCJpbmZpbml0ZSIsIml0ZW1SZXBhaW50IiwicmVzcG9uc2l2ZSIsImJyZWFrcG9pbnQiLCJzZXR0aW5ncyIsImFzTmF2Rm9yIiwiZm9jdXNPblNlbGVjdCIsIm1vYmlsZVNsaWRlciIsInJlcGFpbnRNb2JpbGVTbGlkZXIiLCJ2YWx1ZURPTSIsInNsaWRlcnMiLCJ2ZXJ0aWNhbCIsImN1cnJlbnRTbGlkZSIsIm5leHRTbGlkZSIsInNsaWRlciIsInByZXYiLCJzaXplIiwidmlzaWJsZSIsInNtYWxsQW1vdW50Iiwic2V0U2xpZGVyQXJyb3dzIl0sIm1hcHBpbmdzIjoiYUFBQUEsRUFBRSxXQUVBLElBQU1DLEVBQVVELEVBQUUsWUFDWkUsRUFBT0YsRUFBRSxRQUNURyxFQUFlSCxFQUFFLGlDQUNqQkksRUFBWUosRUFBRSxlQUNkSyxFQUFpQkwsRUFBRSxxQkFDbkJN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QyxFQUFPOUUsRUFBRWlJLEdBQVE1RixLQUFLLGVBQ3RCOEYsRUFBT25JLEVBQUVpSSxHQUFRNUYsS0FBSyxnQkFBZ0JRLE9BQ3RDdUYsRUFBVXBJLEVBQUVpSSxHQUFRNUYsS0FBSyw2QkFBNkJRLE9BQ3REd0YsRUFBY0QsRUFBVSxJQUFNRCxFQUNsQixJQUFkSCxHQUNGRSxFQUFLaEcsU0FBUyxZQUNkNEMsRUFBSzFELFlBQVksYUFFakI4RyxFQUFLOUcsWUFBWSxZQUVmaUgsRUFDeUJGLEdBQXZCSCxFQUFZSSxHQUNkdEQsRUFBSzVDLFNBQVMsWUFDZGdHLEVBQUs5RyxZQUFZLGFBRWpCMEQsRUFBSzFELFlBQVksWUFHTytHLEVBQU8sRUFBN0JILEVBQVlJLEdBQ2R0RCxFQUFLNUMsU0FBUyxZQUNkZ0csRUFBSzlHLFlBQVksYUFFakIwRCxFQUFLMUQsWUFBWSxZQTdCbkJrSCxDQUFnQnRJLEVBQUV5QixNQUFPdUciLCJmaWxlIjoic2NyaXB0cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgY29uc3Qgd3JhcHBlciA9ICQoJy53cmFwcGVyJyk7XHJcbiAgY29uc3QgYm9keSA9ICQoJ2JvZHknKTtcclxuICBjb25zdCBoZWFkZXJCb3R0b20gPSAkKCcuaGVhZGVyLWJvdHRvbSAud3JhcHBlci1pbm5lcicpO1xyXG4gIGNvbnN0IGhlYWRlck5hdiA9ICQoJy5oZWFkZXItbmF2Jyk7XHJcbiAgY29uc3QgaGVhZGVyQ29udGFjdHMgPSAkKCcuaGVhZGVyIC5jb250YWN0cycpO1xyXG4gIGNvbnN0IGhlYWRlckFkZHJlc3MgPSAkKCcuaGVhZGVyIC5hZGRyZXNzLWhvdXJzJyk7XHJcbiAgY29uc3QgaGVhZGVyU2VhcmNoID0gJCgnLmhlYWRlci1zZWFyY2gnKTtcclxuICBjb25zdCBoZWFkZXJDYXJ0ID0gJCgnLmhlYWRlci1jYXJ0Jyk7XHJcbiAgY29uc3QgZm9vdGVyU3Vic2NyaWJlID0gJCgnLmZvb3Rlci1zdWJzY3JpYmUnKTtcclxuICBjb25zdCBmb290ZXJDb3B5cmlnaHRzID0gJCgnLmZvb3Rlci1jb3B5cmlnaHRzJyk7XHJcbiAgY29uc3QgZm9vdGVyU29jaWFsID0gJCgnLmZvb3Rlci1zb2NpYWwnKTtcclxuICBjb25zdCBjaG9vc2VyID0gJCgnLmNob29zZXInKTtcclxuICBjb25zdCBjaG9vc2VyQ29sb3IgPSAkKCcuY2hvb3Nlci5jaG9vc2VyLWNvbG9yJyk7XHJcblxyXG4gIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgd3JhcHBlci5hbmltYXRlKHtvcGFjaXR5OiAxfSwgNTAwKTtcclxuICB9LCA1MDApO1xyXG5cclxuICBwYWdlUmVwYWludCgpO1xyXG5cclxuICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcclxuICAgIHBhZ2VSZXBhaW50KCk7XHJcbiAgfSk7XHJcblxyXG4gICQoJ1tkYXRhLXJlbW92YWJsZS1jbG9zZV0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAkKHRoaXMpLnBhcmVudHMoJ1tkYXRhLXJlbW92YWJsZV0nKVxyXG4gICAgICAuZmFkZU91dCg0MDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkKHRoaXMpLmRldGFjaCgpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgJCgnLmhlYWRlci1zZWFyY2ggYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCBmb3JtID0gJCh0aGlzKS5wYXJlbnRzKCcuaGVhZGVyLXNlYXJjaCcpO1xyXG4gICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgMTIwMCkge1xyXG4gICAgICBpZiAoZm9ybS5oYXNDbGFzcygnYWN0aXZlJykpIHtcclxuICAgICAgICBmb3JtLnN1Ym1pdCgpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZvcm0uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBmb3JtLnN1Ym1pdCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKCcuZmllbGQtcmF0ZS1saXN0IGknKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCB2YWx1ZSA9ICQodGhpcykuaW5kZXgoKSArIDE7XHJcbiAgICAkKHRoaXMpLnBhcmVudHMoJy5maWVsZC1yYXRlJykuZmluZCgnaW5wdXRbdHlwZT1cImhpZGRlblwiXScpLnZhbCh2YWx1ZSk7XHJcbiAgICAkKHRoaXMpLnBhcmVudHMoJy5maWVsZC1yYXRlLWxpc3QnKS5maW5kKCdpJykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVsZW1lbnQpIHtcclxuICAgICAgaWYgKGluZGV4ID49IHZhbHVlKSB7XHJcbiAgICAgICAgJChlbGVtZW50KS5yZW1vdmVDbGFzcygnZmEtcmVkJykuYWRkQ2xhc3MoJ2ZhLWdyZXknKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKGVsZW1lbnQpLnJlbW92ZUNsYXNzKCdmYS1ncmV5JykuYWRkQ2xhc3MoJ2ZhLXJlZCcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgJCgnLmZpZWxkLWZpbGUgaW5wdXRbdHlwZT1cImZpbGVcIl0nKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgdmFsQXJyYXkgPSAkKHRoaXMpLnZhbCgpLnNwbGl0KCdcXFxcJyk7XHJcbiAgICAkKHRoaXMpLnNpYmxpbmdzKCcuZmllbGQtZmlsZS10ZXh0JykudGV4dCh2YWxBcnJheVt2YWxBcnJheS5sZW5ndGggLSAxXSk7XHJcbiAgfSk7XHJcblxyXG4gICQoJ2lucHV0W3R5cGU9XCJ0ZWxcIl0nKS5tYXNrKFwiKzcgKDk5OSkgOTk5LTk5OS05OVwiKTtcclxuXHJcbiAgJCgnLmhlYWRlci1idXJnZXInKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAkKHRoaXMpLnBhcmVudHMoJy5oZWFkZXInKS50b2dnbGVDbGFzcygnbWVudS1vcGVuZWQnKTtcclxuICB9KTtcclxuXHJcbiAgJCgnW2RhdGEtY2FsbC1tb2RhbF0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCB0YXJnZXQgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtY2FsbC1tb2RhbCcpO1xyXG4gICAgY29uc3Qgc2Nyb2xsVmFsdWUgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XHJcbiAgICBib2R5LmFkZENsYXNzKCdtb2RhbC1vcGVuZWQnKTtcclxuICAgICQoYFtkYXRhLW1vZGFsPVwiJHt0YXJnZXR9XCJdYCkuZmFkZUluKDMwMCkuY3NzKHtcclxuICAgICAgJ2Rpc3BsYXknOiAnZmxleCcsXHJcbiAgICAgICd0b3AnOiBgJHtzY3JvbGxWYWx1ZX1weGBcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAkKCcubW9kYWwnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9ICQoZXZlbnQudGFyZ2V0KTtcclxuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ21vZGFsLWNsb3NlJykgfHwgIXRhcmdldC5jbG9zZXN0KCcubW9kYWwtaW5uZXInKS5sZW5ndGgpIHtcclxuICAgICAgJCh0aGlzKS5mYWRlT3V0KDMwMCk7XHJcbiAgICAgIGJvZHkucmVtb3ZlQ2xhc3MoJ21vZGFsLW9wZW5lZCcpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKCdbZGF0YS1zZWxlY3QtY29udHJvbF0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoJCh0aGlzKS5wYXJlbnRzKCdbZGF0YS1zZWxlY3RdJykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XHJcbiAgICAgICQodGhpcykucGFyZW50cygnW2RhdGEtc2VsZWN0XScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoJ1tkYXRhLXNlbGVjdF0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQodGhpcykucGFyZW50cygnW2RhdGEtc2VsZWN0XScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgJCgnW2RhdGEtc2VsZWN0XSB1bCBsaScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcclxuICAgICAgY29uc3QgdmFsdWUgPSAkKHRoaXMpLnRleHQoKTtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQodGhpcykuc2libGluZ3MoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQodGhpcykucGFyZW50cygndWwnKS5zaWJsaW5ncygnW2RhdGEtc2VsZWN0LWNvbnRyb2xdJykudGV4dCh2YWx1ZSk7XHJcbiAgICAgICQodGhpcykucGFyZW50cygndWwnKS5zaWJsaW5ncygnaW5wdXQnKS52YWwodmFsdWUpO1xyXG4gICAgICAkKHRoaXMpLnBhcmVudHMoJ1tkYXRhLXNlbGVjdF0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoJy5hbW91bnQtY2hvb3Nlci1jb250cm9sJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgYW1vdW50RE9NID0gJCh0aGlzKS5zaWJsaW5ncygnaW5wdXQnKTtcclxuICAgIGNvbnN0IGFtb3VudFZhbHVlID0gcGFyc2VJbnQoYW1vdW50RE9NLnZhbCgpKTtcclxuICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdhbW91bnQtY2hvb3Nlci1taW51cycpKSB7XHJcbiAgICAgIGlmIChhbW91bnRWYWx1ZSA+IDEpIHtcclxuICAgICAgICBhbW91bnRET00udmFsKGFtb3VudFZhbHVlIC0gMSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoJCh0aGlzKS5oYXNDbGFzcygnYW1vdW50LWNob29zZXItcGx1cycpKSB7XHJcbiAgICAgIGFtb3VudERPTS52YWwoYW1vdW50VmFsdWUgKyAxKTtcclxuICAgIH1cclxuICAgIGFtb3VudERPTS50cmlnZ2VyKCdjaGFuZ2UnKTtcclxuICB9KTtcclxuXHJcbiAgJCgnLmFtb3VudC1jaG9vc2VyIGlucHV0Jykub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcclxuICAgIGNvbnN0IGNvc3RET00gPSAkKHRoaXMpLnBhcmVudHMoJy5hbW91bnQtY2hvb3NlcicpLnNpYmxpbmdzKCcuY2FyZC1jb3N0JykuY2hpbGRyZW4oJy5jYXJkLWNvc3QtdmFsdWUnKTtcclxuICAgIGNvbnN0IGFtb3VudCA9IHBhcnNlSW50KCQodGhpcykudmFsKCkpO1xyXG4gICAgY29uc3QgaXRlbUNvc3QgPSBwYXJzZUludCgkKHRoaXMpLnBhcmVudHMoJy5hbW91bnQtY2hvb3NlcicpLmF0dHIoJ2RhdGEtY29zdCcpKTtcclxuICAgIGNvc3RET00udGV4dChhbW91bnQgKiBpdGVtQ29zdCArICcg0YDRg9CxLicpO1xyXG4gIH0pO1xyXG5cclxuICBjaG9vc2VyLmZpbmQoJy5jaG9vc2VyLXZhbHVlJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKCQodGhpcykuY2xvc2VzdCgnLmNhdGFsb2ctYnJhbmRzJykubGVuZ3RoXHJcbiAgICAgIHx8ICQodGhpcykuY2xvc2VzdCgnLmNob29zZXItY29sb3InKS5sZW5ndGhcclxuICAgICAgJiYgJCh3aW5kb3cpLndpZHRoKCkgPiA3NjcpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuY2hvb3NlcicpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY2hvb3Nlci5maW5kKCd1bCBsaScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcclxuICAgICAgY29uc3QgdmFsdWUgPSAkKHRoaXMpLmh0bWwoKTtcclxuICAgICAgJCh0aGlzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICQodGhpcykucGFyZW50cygnLmNob29zZXInKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIGlmICgkKHRoaXMpLmNsb3Nlc3QoJy5jaG9vc2VyLWNvbG9yJykubGVuZ3RoKSB7XHJcbiAgICAgICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNzY4KSB7XHJcbiAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJ3VsJykuc2libGluZ3MoJy5jaG9vc2VyLXZhbHVlJykuaHRtbCh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICQodGhpcykucGFyZW50cygndWwnKS5zaWJsaW5ncygnaW5wdXQnKS52YWwoJCh0aGlzKS5maW5kKCcuY2hvb3Nlci1jb2xvci10ZXh0JykudGV4dCgpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudHMoJ3VsJykuc2libGluZ3MoJy5jaG9vc2VyLXZhbHVlJykuaHRtbCh2YWx1ZSk7XHJcbiAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCd1bCcpLnNpYmxpbmdzKCdpbnB1dCcpLnZhbCh2YWx1ZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY2hvb3NlckNvbG9yLmZpbmQoJ3VsIGxpJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xyXG4gICAgICBjb25zdCB2YWx1ZSA9ICQodGhpcykuZmluZCgnLmNob29zZXItY29sb3ItdGV4dCcpLnRleHQoKTtcclxuICAgICAgJCh0aGlzKS5wYXJlbnRzKCd1bCcpLnNpYmxpbmdzKCdpbnB1dCcpLnZhbCh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoZG9jdW1lbnQpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gJChldmVudC50YXJnZXQpO1xyXG5cclxuICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnW2RhdGEtc2VsZWN0XScpLmxlbmd0aCA9PT0gMCkgJCgnLmFjdGl2ZVtkYXRhLXNlbGVjdF0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5oZWFkZXItc2VhcmNoJykubGVuZ3RoID09PSAwKSAkKCcuaGVhZGVyLXNlYXJjaCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmNob29zZXInKS5sZW5ndGggPT09IDApIGNob29zZXIucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gcGFnZVJlcGFpbnQoKSB7XHJcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCA3NjgpIHtcclxuICAgICAgcmVuZGVyTW9iaWxlSGVhZGVyKCk7XHJcbiAgICAgIHJlbmRlck1vYmlsZUZvb3RlcigpO1xyXG4gICAgfSBlbHNlIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDEyMDApIHtcclxuICAgICAgcmVuZGVyVGFibGV0SGVhZGVyKCk7XHJcbiAgICAgIHJlbmRlclRhYmxldEZvb3RlcigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaGVhZGVyU2VhcmNoLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgJCgnLmhlYWRlcicpLnJlbW92ZUNsYXNzKCdtZW51LW9wZW5lZCcpO1xyXG4gICAgICByZW5kZXJEZXNrdG9wSGVhZGVyKCk7XHJcbiAgICAgIHJlbmRlckRlc2t0b3BGb290ZXIoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbmRlck1vYmlsZUhlYWRlcigpIHtcclxuICAgIGhlYWRlclNlYXJjaC5pbnNlcnRCZWZvcmUoaGVhZGVyQ2FydCk7XHJcbiAgICBoZWFkZXJDb250YWN0cy5hcHBlbmRUbyhoZWFkZXJOYXYpO1xyXG4gICAgaGVhZGVyQWRkcmVzcy5hcHBlbmRUbyhoZWFkZXJOYXYpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmVuZGVyVGFibGV0SGVhZGVyKCkge1xyXG4gICAgaGVhZGVyU2VhcmNoLmluc2VydEJlZm9yZShoZWFkZXJDYXJ0KTtcclxuICAgIGhlYWRlckNvbnRhY3RzLmFwcGVuZFRvKGhlYWRlckJvdHRvbSk7XHJcbiAgICBoZWFkZXJBZGRyZXNzLmFwcGVuZFRvKGhlYWRlck5hdik7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZW5kZXJEZXNrdG9wSGVhZGVyKCkge1xyXG4gICAgaGVhZGVyU2VhcmNoLmFwcGVuZFRvKGhlYWRlckJvdHRvbSk7XHJcbiAgICBoZWFkZXJDb250YWN0cy5hcHBlbmRUbyhoZWFkZXJCb3R0b20pO1xyXG4gICAgaGVhZGVyQWRkcmVzcy5hcHBlbmRUbyhoZWFkZXJCb3R0b20pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmVuZGVyTW9iaWxlRm9vdGVyKCkge1xyXG4gICAgZm9vdGVyU3Vic2NyaWJlLmluc2VydEFmdGVyKGZvb3RlckNvcHlyaWdodHMpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmVuZGVyVGFibGV0Rm9vdGVyKCkge1xyXG4gICAgZm9vdGVyU3Vic2NyaWJlLmluc2VydEJlZm9yZShmb290ZXJTb2NpYWwpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmVuZGVyRGVza3RvcEZvb3RlcigpIHtcclxuICAgICAgZm9vdGVyU3Vic2NyaWJlLmluc2VydEJlZm9yZShmb290ZXJTb2NpYWwpO1xyXG4gIH1cclxuXHJcbn0pO1xyXG4iLCIkKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgY29uc3QgYm9keSA9ICQoJ2JvZHknKTtcclxuICBjb25zdCBjYXRhbG9nRmlsdGVyID0gJCgnLmNhdGFsb2ctZmlsdGVyJyk7XHJcbiAgY29uc3QgY2F0YWxvZ0FydGljbGVzID0gJCgnLmNhdGFsb2ctYXJ0aWNsZXMnKTtcclxuICBjb25zdCBjYXRhbG9nQmFubmVyID0gJCgnLmNhdGFsb2ctYmFubmVyJyk7XHJcbiAgY29uc3QgYnJlYWRjcnVtYnMgPSAkKCcuYnJlYWRjcnVtYnMnKTtcclxuICBjb25zdCBjYXRhbG9nQXNpZGUgPSAkKCcuY2F0YWxvZy1hc2lkZScpO1xyXG4gIGNvbnN0IGZpbHRlckNvc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyLWNvc3QnKTtcclxuICBjb25zdCBmaWx0ZXJDb3N0SGFuZGxlcyA9W1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlci1jb3N0LWZyb20nKSxcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXItY29zdC10bycpXHJcbiAgXTtcclxuXHJcbiAgY2F0YWxvZ1JlcGFpbnQoKTtcclxuXHJcbiAgaWYgKGZpbHRlckNvc3QpIHtcclxuICAgIG5vVWlTbGlkZXIuY3JlYXRlKGZpbHRlckNvc3QsIHtcclxuICAgICAgc3RhcnQ6IFsxMDAwLCA1MDAwXSxcclxuICAgICAgc3RlcDogMTAwLFxyXG4gICAgICBtYXJnaW46IDEwMDAsXHJcbiAgICAgIGNvbm5lY3Q6IHRydWUsXHJcbiAgICAgIHJhbmdlOiB7XHJcbiAgICAgICAgJ21pbic6IDAsXHJcbiAgICAgICAgJ21heCc6IDgwMDBcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBmaWx0ZXJDb3N0SGFuZGxlcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50LCBpbmRleCkge1xyXG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmaWx0ZXJDb3N0Lm5vVWlTbGlkZXIuc2V0SGFuZGxlKGluZGV4LCBmaWx0ZXJDb3N0SGFuZGxlc1tpbmRleF0udmFsdWUpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgZmlsdGVyQ29zdC5ub1VpU2xpZGVyLm9uKCd1cGRhdGUnLCBmdW5jdGlvbiAodmFsdWVzLCBoYW5kbGUpIHtcclxuICAgICAgZmlsdGVyQ29zdEhhbmRsZXNbaGFuZGxlXS52YWx1ZSA9IE1hdGgudHJ1bmModmFsdWVzW2hhbmRsZV0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcclxuICAgIGNhdGFsb2dSZXBhaW50KCk7XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIGNhdGFsb2dSZXBhaW50ICgpIHtcclxuICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDEyMDApIHtcclxuICAgICAgcmVuZGVyTW9iaWxlQ2F0YWxvZygpO1xyXG4gICAgfSAgZWxzZSB7XHJcbiAgICAgIHJlbmRlckRlc2t0b3BDYXRhbG9nKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZW5kZXJNb2JpbGVDYXRhbG9nICgpIHtcclxuICAgIGJyZWFkY3J1bWJzLnByZXBlbmRUbygkKCcuaGVhZGVyJykubmV4dCgnLndyYXBwZXItaW5uZXInKSk7XHJcbiAgICBpZiAoY2F0YWxvZ0ZpbHRlci5maW5kKCcubW9kYWwtY2xvc2UnKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgJCgnPGRpdiBjbGFzcz1cIm1vZGFsLWNsb3NlXCI+PC9kaXY+JykucHJlcGVuZFRvKGNhdGFsb2dGaWx0ZXIpO1xyXG4gICAgfVxyXG4gICAgY2F0YWxvZ0ZpbHRlci5hcHBlbmRUbygnLm1vZGFsW2RhdGEtbW9kYWw9XCJmaWx0ZXJcIl0nKTtcclxuICAgIGNhdGFsb2dBcnRpY2xlcy5pbnNlcnRBZnRlcignLnBhZ2luYXRpb24nKTtcclxuICAgIGNhdGFsb2dCYW5uZXIuaW5zZXJ0QWZ0ZXIoY2F0YWxvZ0FydGljbGVzKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbmRlckRlc2t0b3BDYXRhbG9nICgpIHtcclxuICAgIGJyZWFkY3J1bWJzLnByZXBlbmRUbygkKCcuY2F0YWxvZy1jb250ZW50JykpO1xyXG4gICAgYm9keS5yZW1vdmVDbGFzcygnbW9kYWwtb3BlbmVkJyk7XHJcbiAgICAkKCcubW9kYWxbZGF0YS1tb2RhbD1cImZpbHRlclwiXScpLmNzcyh7XHJcbiAgICAgICdkaXNwbGF5JzogJ25vbmUnLFxyXG4gICAgICAndG9wJzogJ2F1dG8nXHJcbiAgICB9KTtcclxuICAgIGlmIChjYXRhbG9nRmlsdGVyLmZpbmQoJy5tb2RhbC1jbG9zZScpLmxlbmd0aCkge1xyXG4gICAgICAkKGNhdGFsb2dGaWx0ZXIuZmluZCgnLm1vZGFsLWNsb3NlJykpLmRldGFjaCgpO1xyXG4gICAgfVxyXG4gICAgY2F0YWxvZ0ZpbHRlci5wcmVwZW5kVG8oY2F0YWxvZ0FzaWRlKTtcclxuICAgIGNhdGFsb2dBcnRpY2xlcy5hcHBlbmRUbyhjYXRhbG9nQXNpZGUpO1xyXG4gICAgY2F0YWxvZ0Jhbm5lci5hcHBlbmRUbyhjYXRhbG9nQXNpZGUpO1xyXG4gIH1cclxuXHJcbn0pOyIsIiQoZnVuY3Rpb24gKCkge1xyXG5cclxuICBjb25zdCBoZXJvID0gJCgnLmhlcm8nKTtcclxuXHJcbiAgaWYgKGhlcm8ubGVuZ3RoKSB7XHJcbiAgICBoZXJvLnNsaWNrKHtcclxuICAgICAgZG90czogdHJ1ZSxcclxuICAgICAgYXJyb3dzOiBmYWxzZSxcclxuICAgICAgZmFkZTogdHJ1ZSxcclxuICAgICAgYXV0b3BsYXk6IHRydWUsXHJcbiAgICAgIGF1dG9wbGF5U3BlZWQ6IDUwMDBcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn0pO1xyXG4iLCIkKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgY29uc3QgaXRlbVNsaWRlckxhcmdlID0gJCgnLml0ZW0taW1hZ2UtbGFyZ2UnKTtcclxuICBjb25zdCBpdGVtU2xpZGVyU21hbGwgPSAkKCcuaXRlbS1pbWFnZS1zbWFsbCcpO1xyXG4gIGNvbnN0IHBhcmFtcyA9ICQoJy5pdGVtLXBhcmFtcycpO1xyXG4gIGNvbnN0IGNvbG9yU2xpZGVyID0gJCgnLmNob29zZXIuY2hvb3Nlci1jb2xvciB1bCcpO1xyXG4gIGNvbnN0IGl0ZW1MaXN0ID0gJCgnLml0ZW0gLml0ZW0tbGlzdCcpO1xyXG4gIGNvbnN0IGl0ZW1JbWFnZSA9ICQoJy5pdGVtLWltYWdlJyk7XHJcbiAgY29uc3QgaXRlbUZvcm1IZWFkZXIgPSAkKCcuaXRlbS1mb3JtLWhlYWRlcicpO1xyXG4gIGNvbnN0IGl0ZW1EZWxpdmVyeSA9ICQoJy5pdGVtLWRlbGl2ZXJ5Jyk7XHJcbiAgY29uc3QgaXRlbUZvcm0gPSAkKCcuaXRlbS1mb3JtJyk7XHJcblxyXG4gIGl0ZW1SZXBhaW50KCk7XHJcblxyXG4gIHJlcGFpbnRDb2xvclNsaWRlcihjb2xvclNsaWRlcik7XHJcblxyXG4gIGlmIChwYXJhbXMubGVuZ3RoKSB7XHJcbiAgICBwYXJhbXMuc2xpY2soe1xyXG4gICAgICBzbGlkZXNUb1Nob3c6IDMsXHJcbiAgICAgIHJlc3BvbnNpdmU6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBicmVha3BvaW50OiAxMjAwLFxyXG4gICAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgICAgc2xpZGVzVG9TaG93OiA0XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBicmVha3BvaW50OiA3NjgsXHJcbiAgICAgICAgICBzZXR0aW5nczoge1xyXG4gICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDJcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIF1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaWYgKGl0ZW1TbGlkZXJMYXJnZS5sZW5ndGggJiYgaXRlbVNsaWRlclNtYWxsLmxlbmd0aCkge1xyXG5cclxuICAgIGl0ZW1TbGlkZXJMYXJnZS5zbGljayh7XHJcbiAgICAgIGFycm93czogZmFsc2UsXHJcbiAgICAgIGZhZGU6IHRydWUsXHJcbiAgICAgIGFzTmF2Rm9yOiAnLml0ZW0taW1hZ2Utc21hbGwnXHJcbiAgICB9KTtcclxuXHJcbiAgICBpdGVtU2xpZGVyU21hbGwuc2xpY2soe1xyXG4gICAgICBzbGlkZXNUb1Nob3c6IDQsXHJcbiAgICAgIGZvY3VzT25TZWxlY3Q6IHRydWUsXHJcbiAgICAgIGFzTmF2Rm9yOiAnLml0ZW0taW1hZ2UtbGFyZ2UnLFxyXG4gICAgICByZXNwb25zaXZlOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgYnJlYWtwb2ludDogMTIwMCxcclxuICAgICAgICAgIHNldHRpbmdzOiB7XHJcbiAgICAgICAgICAgIHNsaWRlc1RvU2hvdzogMlxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXBhaW50Q29sb3JTbGlkZXIoY29sb3JTbGlkZXIpO1xyXG4gICAgaXRlbVJlcGFpbnQoKTtcclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gcmVwYWludENvbG9yU2xpZGVyKGNvbG9yU2xpZGVyKSB7XHJcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCA3NjgpIHtcclxuICAgICAgJChjb2xvclNsaWRlcikuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ3NsaWNrLXNsaWRlcicpKSB7XHJcbiAgICAgICAgICAkKHRoaXMpLnNsaWNrKCd1bnNsaWNrJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoY29sb3JTbGlkZXIpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnc2xpY2stc2xpZGVyJykpIHtcclxuICAgICAgICAgICQodGhpcykuc2xpY2soe1xyXG4gICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDMsXHJcbiAgICAgICAgICAgIGluZmluaXRlOiBmYWxzZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGl0ZW1SZXBhaW50KCkge1xyXG4gICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNzY4KSB7XHJcbiAgICAgIHJlbmRlck1vYmlsZUl0ZW0oKTtcclxuICAgIH0gZWxzZSBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCAxMjAwKSB7XHJcbiAgICAgIHJlbmRlclRhYmxldEl0ZW0oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlbmRlckRlc2t0b3BJdGVtKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZW5kZXJNb2JpbGVJdGVtICgpIHtcclxuICAgIGl0ZW1MaXN0Lmluc2VydEFmdGVyKGl0ZW1Gb3JtSGVhZGVyKTtcclxuICAgIGl0ZW1EZWxpdmVyeS5pbnNlcnRBZnRlcihpdGVtRm9ybSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZW5kZXJUYWJsZXRJdGVtICgpIHtcclxuICAgIGl0ZW1MaXN0LmFwcGVuZFRvKGl0ZW1JbWFnZSk7XHJcbiAgICBpdGVtRGVsaXZlcnkuaW5zZXJ0QWZ0ZXIoaXRlbUZvcm0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmVuZGVyRGVza3RvcEl0ZW0gKCkge1xyXG4gICAgaXRlbUxpc3QuYXBwZW5kVG8oaXRlbUltYWdlKTtcclxuICAgIGl0ZW1EZWxpdmVyeS5hcHBlbmRUbyhpdGVtRm9ybSk7XHJcbiAgfVxyXG5cclxufSk7IiwiJChmdW5jdGlvbiAoKSB7XHJcblxyXG4gIGNvbnN0IG1vYmlsZVNsaWRlciA9ICQoJy5hZHZhbnRhZ2VzIHVsLCAucmV2aWV3cy1yYXRlJyk7XHJcblxyXG4gIHJlcGFpbnRNb2JpbGVTbGlkZXIobW9iaWxlU2xpZGVyKTtcclxuXHJcbiAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXBhaW50TW9iaWxlU2xpZGVyKG1vYmlsZVNsaWRlcik7XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIHJlcGFpbnRNb2JpbGVTbGlkZXIobW9iaWxlU2xpZGVyKSB7XHJcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCA3NjgpIHtcclxuICAgICAgJChtb2JpbGVTbGlkZXIpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnc2xpY2stc2xpZGVyJykpIHtcclxuICAgICAgICAgICQodGhpcykuc2xpY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgJChtb2JpbGVTbGlkZXIpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdzbGljay1zbGlkZXInKSkge1xyXG4gICAgICAgICAgJCh0aGlzKS5zbGljaygndW5zbGljaycpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufSk7XHJcbiIsIiQoZnVuY3Rpb24gKCkge1xyXG5cclxuICBjb25zdCByZXZpZXdzUmVzdWx0UGVyY2VudCA9ICQoJy5yZXZpZXdzLXJlc3VsdC1wZXJjZW50Jyk7XHJcblxyXG4gIHJldmlld3NSZXN1bHRQZXJjZW50LmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgdmFsdWUgPSBwYXJzZUludCgkKHRoaXMpLmF0dHIoJ2RhdGEtcmVzdWx0LXBlcmNlbnQnKSk7XHJcbiAgICBjb25zdCB2YWx1ZURPTSA9ICQodGhpcykuZmluZCgnLnJldmlld3MtcmVzdWx0LXBlcmNlbnQtdmFsdWUnKTtcclxuICAgICQoJzxkaXYgY2xhc3M9XCJyZXZpZXdzLXJlc3VsdC1wZXJjZW50LWNvbG9yXCI+PC9kaXY+JylcclxuICAgICAgLmFwcGVuZFRvKHZhbHVlRE9NKS5jc3MoJ3dpZHRoJywgdmFsdWUgKyAnJScpO1xyXG4gIH0pO1xyXG5cclxuICAkKCcucmV2aWV3cy1saXN0IC5yZXZpZXdzLWNhcmQgcCAuc2hvdy1hbGwnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAkKHRoaXMpLnNpYmxpbmdzKCcuYWxsLXRleHQnKS5jc3MoJ2Rpc3BsYXknLCAnaW5saW5lJyk7XHJcbiAgICAkKHRoaXMpLnNpYmxpbmdzKCcuZG90cycpLmNzcygnZGlzcGxheScsICdub25lJyk7XHJcbiAgICAkKHRoaXMpLmNzcygnZGlzcGxheScsICdub25lJyk7XHJcbiAgfSk7XHJcblxyXG59KTsiLCIkKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgY29uc3Qgc2xpZGVycyA9ICQoJy5jZXJ0aWZpY2F0ZXMtbGlzdCwgLnByb2R1Y3QtbGlzdCwgLmFydGljbGVzLWxpc3QsIC5yZXZpZXdzLXNsaWRlcicpO1xyXG5cclxuICBpZiAoc2xpZGVycy5sZW5ndGgpIHtcclxuXHJcbiAgICBzbGlkZXJzLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygncHJvZHVjdC1saXN0JykgfHwgJCh0aGlzKS5oYXNDbGFzcygnY2VydGlmaWNhdGVzLWxpc3QnKSkge1xyXG4gICAgICAgICQodGhpcykuc2xpY2soe1xyXG4gICAgICAgICAgc2xpZGVzVG9TaG93OiA0LFxyXG4gICAgICAgICAgaW5maW5pdGU6IGZhbHNlLFxyXG4gICAgICAgICAgcmVzcG9uc2l2ZTogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgYnJlYWtwb2ludDogMTIwMCxcclxuICAgICAgICAgICAgICBzZXR0aW5nczoge1xyXG4gICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiAzLFxyXG4gICAgICAgICAgICAgICAgaW5maW5pdGU6IGZhbHNlXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgYnJlYWtwb2ludDogOTMwLFxyXG4gICAgICAgICAgICAgIHNldHRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDIsXHJcbiAgICAgICAgICAgICAgICBpbmZpbml0ZTogZmFsc2VcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBicmVha3BvaW50OiA3NjgsXHJcbiAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgICAgICAgIGluZmluaXRlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiAxXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICBdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCh0aGlzKS5zbGljayh7XHJcbiAgICAgICAgICBzbGlkZXNUb1Nob3c6IDIsXHJcbiAgICAgICAgICB2ZXJ0aWNhbDpmYWxzZSxcclxuICAgICAgICAgIGluZmluaXRlOiBmYWxzZSxcclxuICAgICAgICAgIHJlc3BvbnNpdmU6IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDEyMDAsXHJcbiAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgICAgICAgIHNsaWRlc1RvU2hvdzogMixcclxuICAgICAgICAgICAgICAgIGluZmluaXRlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHZlcnRpY2FsOiB0cnVlXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgYnJlYWtwb2ludDogNzY4LFxyXG4gICAgICAgICAgICAgIHNldHRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDEsXHJcbiAgICAgICAgICAgICAgICBpbmZpbml0ZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHZlcnRpY2FsOiBmYWxzZVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgICQodGhpcykuZmluZCgnLnNsaWNrLXByZXYnKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHNsaWRlcnMub24oJ2JlZm9yZUNoYW5nZScsIGZ1bmN0aW9uKGV2ZW50LCBzbGljaywgY3VycmVudFNsaWRlLCBuZXh0U2xpZGUpIHtcclxuICAgICAgc2V0U2xpZGVyQXJyb3dzKCQodGhpcyksIG5leHRTbGlkZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzZXRTbGlkZXJBcnJvd3MgKHNsaWRlciwgbmV4dFNsaWRlKSB7XHJcbiAgICBjb25zdCBwcmV2ID0gJChzbGlkZXIpLmZpbmQoJy5zbGljay1wcmV2Jyk7XHJcbiAgICBjb25zdCBuZXh0ID0gJChzbGlkZXIpLmZpbmQoJy5zbGljay1uZXh0Jyk7XHJcbiAgICBjb25zdCBzaXplID0gJChzbGlkZXIpLmZpbmQoJy5zbGljay1zbGlkZScpLmxlbmd0aDtcclxuICAgIGNvbnN0IHZpc2libGUgPSAkKHNsaWRlcikuZmluZCgnLnNsaWNrLXNsaWRlLnNsaWNrLWFjdGl2ZScpLmxlbmd0aDtcclxuICAgIGNvbnN0IHNtYWxsQW1vdW50ID0gdmlzaWJsZSArIDEgPT09IHNpemU7XHJcbiAgICBpZiAobmV4dFNsaWRlID09PSAwKSB7XHJcbiAgICAgIHByZXYuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICAgIG5leHQucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBwcmV2LnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgfVxyXG4gICAgaWYgKHNtYWxsQW1vdW50KSB7XHJcbiAgICAgIGlmIChuZXh0U2xpZGUgKyB2aXNpYmxlID49IHNpemUpIHtcclxuICAgICAgICBuZXh0LmFkZENsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgICAgIHByZXYucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbmV4dC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKG5leHRTbGlkZSArIHZpc2libGUgPiBzaXplIC0gMSkge1xyXG4gICAgICAgIG5leHQuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICAgICAgcHJldi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBuZXh0LnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufSk7XHJcbiJdfQ==
