"use strict";$(function(){var e=$(".wrapper"),i=$("body"),t=$(".header-bottom .wrapper-inner"),s=$(".header-nav"),a=$(".header .contacts"),n=$(".header .address-hours"),o=$(".header-search"),l=$(".header-cart"),c=$(".footer-subscribe"),r=$(".footer-copyrights"),d=$(".footer-social"),h=$(".chooser"),f=$(".chooser.chooser-color"),p=$(".color-list li");function u(){$(window).width()<768?(o.insertBefore(l),a.appendTo(s),n.appendTo(s),c.insertAfter(r)):($(window).width()<1200?(o.insertBefore(l),a.appendTo(t),n.appendTo(s)):(o.removeClass("active"),$(".header").removeClass("menu-opened"),o.appendTo(t),a.appendTo(t),n.appendTo(t)),c.insertBefore(d))}setTimeout(function(){e.animate({opacity:1},500)},500),u(),p.each(function(){$(this).attr("data-background",$(this).css("background-color"))}),$(window).on("resize",function(){u()}),$("[data-removable-close]").on("click",function(){$(this).parents("[data-removable]").fadeOut(400,function(){$(this).detach()})}),$('.header-search button[type="submit"]').on("click",function(e){e.preventDefault();var t=$(this).parents(".header-search");$(window).width()<1200?t.hasClass("active")?t.submit():t.addClass("active"):t.submit()}),$(".field-rate-list i").on("click",function(){var s=$(this).index()+1;$(this).parents(".field-rate").find('input[type="hidden"]').val(s),$(this).parents(".field-rate-list").find("i").each(function(e,t){s<=e?$(t).removeClass("fa-red").addClass("fa-grey"):$(t).removeClass("fa-grey").addClass("fa-red")})}),$('.field-file input[type="file"]').on("change",function(){var e=$(this).val().split("\\");$(this).siblings(".field-file-text").text(e[e.length-1])}),$('input[type="tel"]').mask("+7 (999) 999-999-99"),$(".header-burger").on("click",function(){$(this).parents(".header").toggleClass("menu-opened")}),$("[data-call-modal]").on("click",function(){var e=$(this).attr("data-call-modal"),t=$(window).scrollTop(),s=$('[data-modal="'.concat(e,'"]'));i.addClass("modal-opened"),s.fadeIn(300).css({display:"flex",top:"".concat(t,"px")}),$(document).on("touchmove",function(e){e.preventDefault()})}),$(".modal").on("click",function(e){var t=$(e.target);!t.hasClass("modal-close")&&t.closest(".modal-inner").length||($(this).fadeOut(300),i.removeClass("modal-opened"),$(document).off("touchmove"))}),$("[data-select-control]").on("click",function(){$(this).parents("[data-select]").hasClass("active")?$(this).parents("[data-select]").removeClass("active"):($("[data-select]").removeClass("active"),$(this).parents("[data-select]").addClass("active"))}),$("[data-select] ul li").on("click",function(){if(!$(this).hasClass("active")){var e=$(this).text();$(this).addClass("active"),$(this).siblings(".active").removeClass("active"),$(this).parents("ul").siblings("[data-select-control]").text(e),$(this).parents("ul").siblings("input").val(e),$(this).parents("[data-select]").removeClass("active")}}),$(".amount-chooser-control").on("click",function(){var e=$(this).siblings("input"),t=parseInt(e.val());$(this).hasClass("amount-chooser-minus")?1<t&&e.val(t-1):$(this).hasClass("amount-chooser-plus")&&e.val(t+1),e.trigger("change")}),$(".amount-chooser input").on("change",function(){var e=$(this).parents(".amount-chooser").siblings(".card-cost").children(".card-cost-value"),t=parseInt($(this).val()),s=parseInt($(this).parents(".amount-chooser").attr("data-cost"));e.text(t*s+" руб.")}),p.on("click",function(){$(this).hasClass("active")||($(this).addClass("active"),$(this).siblings().removeClass("active"))}),h.find(".chooser-value").on("click",function(){if($(this).closest(".catalog-brands").length&&767<$(window).width()||$(this).closest(".chooser-color").length&&767<$(window).width())return console.log("hello"),!1;$(this).parents(".chooser").hasClass("active")?$(this).parents(".chooser").removeClass("active"):(h.removeClass("active"),$(this).parents(".chooser").addClass("active"))}),h.find("ul li").on("click",function(){if(!$(this).hasClass("active")&&0===$(this).closest(".catalog-brands").length){var e=$(this).html();$(this).siblings().removeClass("active"),$(this).addClass("active"),$(this).parents(".chooser").removeClass("active"),$(this).closest(".chooser-color").length?($(window).width()<768&&$(this).parents("ul").siblings(".chooser-value").html(e),$(this).parents("ul").siblings("input").val($(this).find(".chooser-color-text").text())):($(this).parents("ul").siblings(".chooser-value").html(e),$(this).parents("ul").siblings("input").val(e))}}),f.find("ul li").on("click",function(e){if(e.preventDefault(),!$(this).hasClass("active")){var t=$(this).find(".chooser-color-text").text();$(this).parents("ul").siblings("input").val(t)}}),$(document).on("click",function(e){var t=$(e.target);0===t.closest("[data-select]").length&&$(".active[data-select]").removeClass("active"),0===t.closest(".header-search").length&&$(".header-search").removeClass("active"),0===t.closest(".chooser").length&&h.removeClass("active")})}),$(function(){var e=$("body"),t=$(".catalog-filter"),s=$(".catalog-articles"),i=$(".catalog-banner"),a=$(".breadcrumbs"),n=$(".catalog-aside"),o=document.getElementById("filter-cost"),l=[document.getElementById("filter-cost-from"),document.getElementById("filter-cost-to")];function c(){$(window).width()<1200?function(){a.prependTo($(".header").next(".wrapper-inner")),0===t.find(".modal-close").length&&$('<div class="modal-close"></div>').prependTo(t);t.appendTo('.modal[data-modal="filter"]'),s.insertAfter(".pagination"),i.insertAfter(s)}():function(){a.prependTo($(".catalog-content")),e.removeClass("modal-opened"),$('.modal[data-modal="filter"]').css({display:"none",top:"auto"}),t.find(".modal-close").length&&$(t.find(".modal-close")).detach();t.prependTo(n),s.appendTo(n),i.appendTo(n)}()}c(),$(".chooser-color li").each(function(){$(this).attr("data-background",$(this).find("span").eq(0).css("background-color"))}),o&&(noUiSlider.create(o,{start:[1e3,5e3],step:100,margin:1e3,connect:!0,range:{min:0,max:8e3}}),l.forEach(function(e,t){e.addEventListener("change",function(){o.noUiSlider.setHandle(t,l[t].value)})}),o.noUiSlider.on("update",function(e,t){l[t].value=Math.trunc(e[t])})),$(window).on("resize",function(){c()})}),$(function(){var e=$(".hero");e.length&&e.slick({dots:!0,arrows:!1,fade:!0,autoplay:!0,autoplaySpeed:5e3})}),$(function(){var e=$(".item-image-large"),t=$(".item-image-small"),s=$(".item-params"),i=$(".chooser.chooser-color ul"),a=$(".item .item-list"),n=$(".item-image"),o=$(".item-form-header"),l=$(".item-delivery"),c=$(".item-form");function r(e){$(window).width()<768?$(e).each(function(){$(this).hasClass("slick-slider")&&$(this).slick("unslick")}):$(e).each(function(){$(this).hasClass("slick-slider")||$(this).slick({slidesToShow:3,infinite:!1})})}function d(){$(window).width()<768?(a.insertAfter(o),l.insertAfter(c)):$(window).width()<1200?(a.appendTo(n),l.insertAfter(c)):(a.appendTo(n),l.appendTo(c))}d(),r(i),s.length&&s.slick({slidesToShow:3,responsive:[{breakpoint:1200,settings:{slidesToShow:4}},{breakpoint:768,settings:{slidesToShow:2}}]}),e.length&&t.length&&(e.slick({arrows:!1,fade:!0,asNavFor:".item-image-small"}),t.slick({slidesToShow:4,focusOnSelect:!0,asNavFor:".item-image-large",responsive:[{breakpoint:1200,settings:{slidesToShow:2}}]})),$(window).on("resize",function(){r(i),d()}),$(".item-tab-header li").on("click",function(){if($(this).hasClass("active"))$(window).width()<768&&$(this).parents(".item-tab-header").toggleClass("active");else{var e=$(this).attr("data-tab");$(".item-tab-content > li").fadeOut(0),$(".item-tab-content").find('li[data-tab="'+e+'"]').fadeIn(),$(this).siblings().removeClass("active"),$(this).addClass("active"),$(window).width()<768&&$(this).parents(".item-tab-header").removeClass("active")}}),$(".item-list-all").on("click",function(){$("html, body").animate({scrollTop:$(".item-tab-content").offset().top-120},400,function(){$('.item-tab-header li[data-tab="params"]').addClass("active").siblings().removeClass("active"),$('.item-tab-content li[data-tab="params"]').fadeIn().siblings().fadeOut(0)})})}),$(function(){var e=$(".advantages ul, .reviews-rate");function t(e){$(window).width()<768?$(e).each(function(){$(this).hasClass("slick-slider")||$(this).slick()}):$(e).each(function(){$(this).hasClass("slick-slider")&&$(this).slick("unslick")})}t(e),$(window).on("resize",function(){t(e)})}),$(function(){$(".reviews-result-percent").each(function(){var e=parseInt($(this).attr("data-result-percent")),t=$(this).find(".reviews-result-percent-value");$('<div class="reviews-result-percent-color"></div>').appendTo(t).css("width",e+"%")}),$(".reviews-list .reviews-card p .show-all").on("click",function(){$(this).siblings(".all-text").css("display","inline"),$(this).siblings(".dots").css("display","none"),$(this).css("display","none")})}),$(function(){var e=$(".certificates-list, .product-list, .articles-list, .reviews-slider");e.length&&(e.each(function(){$(this).hasClass("product-list")||$(this).hasClass("certificates-list")?$(this).slick({slidesToShow:4,infinite:!1,responsive:[{breakpoint:1200,settings:{slidesToShow:3,infinite:!1}},{breakpoint:930,settings:{slidesToShow:2,infinite:!1}},{breakpoint:768,settings:{infinite:!0,slidesToShow:1}}]}):$(this).slick({slidesToShow:2,vertical:!1,infinite:!1,responsive:[{breakpoint:1200,settings:{slidesToShow:2,infinite:!1,vertical:!0}},{breakpoint:768,settings:{slidesToShow:1,infinite:!0,vertical:!1}}]}),$(this).find(".slick-prev").addClass("disabled")}),e.on("beforeChange",function(e,t,s,i){!function(e,t){var s=$(e).find(".slick-prev"),i=$(e).find(".slick-next"),a=$(e).find(".slick-slide").length,n=$(e).find(".slick-slide.slick-active").length,o=n+1===a;0===t?(s.addClass("disabled"),i.removeClass("disabled")):s.removeClass("disabled");o?a<=t+n?(i.addClass("disabled"),s.removeClass("disabled")):i.removeClass("disabled"):a-1<t+n?(i.addClass("disabled"),s.removeClass("disabled")):i.removeClass("disabled")}($(this),i)}))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjYXRhbG9nLmpzIiwiaGVyby5qcyIsIml0ZW0uanMiLCJtb2JpbGVTbGlkZXIuanMiLCJyZXZpZXdzLmpzIiwic2xpZGVycy5qcyJdLCJuYW1lcyI6WyIkIiwid3JhcHBlciIsImJvZHkiLCJoZWFkZXJCb3R0b20iLCJoZWFkZXJOYXYiLCJoZWFkZXJDb250YWN0cyIsImhlYWRlckFkZHJlc3MiLCJoZWFkZXJTZWFyY2giLCJoZWFkZXJDYXJ0IiwiZm9vdGVyU3Vic2NyaWJlIiwiZm9vdGVyQ29weXJpZ2h0cyIsImZvb3RlclNvY2lhbCIsImNob29zZXIiLCJjaG9vc2VyQ29sb3IiLCJjb2xvckl0ZW0iLCJwYWdlUmVwYWludCIsIndpbmRvdyIsIndpZHRoIiwiaW5zZXJ0QmVmb3JlIiwiYXBwZW5kVG8iLCJpbnNlcnRBZnRlciIsInJlbW92ZUNsYXNzIiwic2V0VGltZW91dCIsImFuaW1hdGUiLCJvcGFjaXR5IiwiZWFjaCIsInRoaXMiLCJhdHRyIiwiY3NzIiwib24iLCJwYXJlbnRzIiwiZmFkZU91dCIsImRldGFjaCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJmb3JtIiwiaGFzQ2xhc3MiLCJzdWJtaXQiLCJhZGRDbGFzcyIsInZhbHVlIiwiaW5kZXgiLCJmaW5kIiwidmFsIiwiZWxlbWVudCIsInZhbEFycmF5Iiwic3BsaXQiLCJzaWJsaW5ncyIsInRleHQiLCJsZW5ndGgiLCJtYXNrIiwidG9nZ2xlQ2xhc3MiLCJ0YXJnZXQiLCJzY3JvbGxWYWx1ZSIsInNjcm9sbFRvcCIsIm1vZGFsIiwiY29uY2F0IiwiZmFkZUluIiwiZGlzcGxheSIsInRvcCIsImRvY3VtZW50IiwiY2xvc2VzdCIsIm9mZiIsImFtb3VudERPTSIsImFtb3VudFZhbHVlIiwicGFyc2VJbnQiLCJ0cmlnZ2VyIiwiY29zdERPTSIsImNoaWxkcmVuIiwiYW1vdW50IiwiaXRlbUNvc3QiLCJjb25zb2xlIiwibG9nIiwiaHRtbCIsImNhdGFsb2dGaWx0ZXIiLCJjYXRhbG9nQXJ0aWNsZXMiLCJjYXRhbG9nQmFubmVyIiwiYnJlYWRjcnVtYnMiLCJjYXRhbG9nQXNpZGUiLCJmaWx0ZXJDb3N0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmaWx0ZXJDb3N0SGFuZGxlcyIsImNhdGFsb2dSZXBhaW50IiwicHJlcGVuZFRvIiwibmV4dCIsInJlbmRlck1vYmlsZUNhdGFsb2ciLCJyZW5kZXJEZXNrdG9wQ2F0YWxvZyIsImVxIiwibm9VaVNsaWRlciIsImNyZWF0ZSIsInN0YXJ0Iiwic3RlcCIsIm1hcmdpbiIsImNvbm5lY3QiLCJyYW5nZSIsIm1pbiIsIm1heCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwic2V0SGFuZGxlIiwidmFsdWVzIiwiaGFuZGxlIiwiTWF0aCIsInRydW5jIiwiaGVybyIsInNsaWNrIiwiZG90cyIsImFycm93cyIsImZhZGUiLCJhdXRvcGxheSIsImF1dG9wbGF5U3BlZWQiLCJpdGVtU2xpZGVyTGFyZ2UiLCJpdGVtU2xpZGVyU21hbGwiLCJwYXJhbXMiLCJjb2xvclNsaWRlciIsIml0ZW1MaXN0IiwiaXRlbUltYWdlIiwiaXRlbUZvcm1IZWFkZXIiLCJpdGVtRGVsaXZlcnkiLCJpdGVtRm9ybSIsInJlcGFpbnRDb2xvclNsaWRlciIsInNsaWRlc1RvU2hvdyIsImluZmluaXRlIiwiaXRlbVJlcGFpbnQiLCJyZXNwb25zaXZlIiwiYnJlYWtwb2ludCIsInNldHRpbmdzIiwiYXNOYXZGb3IiLCJmb2N1c09uU2VsZWN0IiwiY3VycmVudCIsIm9mZnNldCIsIm1vYmlsZVNsaWRlciIsInJlcGFpbnRNb2JpbGVTbGlkZXIiLCJ2YWx1ZURPTSIsInNsaWRlcnMiLCJ2ZXJ0aWNhbCIsImN1cnJlbnRTbGlkZSIsIm5leHRTbGlkZSIsInNsaWRlciIsInByZXYiLCJzaXplIiwidmlzaWJsZSIsInNtYWxsQW1vdW50Iiwic2V0U2xpZGVyQXJyb3dzIl0sIm1hcHBpbmdzIjoiYUFBQUEsRUFBRSxXQUVBLElBQU1DLEVBQVVELEVBQUUsWUFDWkUsRUFBT0Ys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RUFBRTBCLE1BQU04RSxNQUFNLENBQ1pnQixhQUFjLEVBQ2RjLFVBQVMsRUFDVGIsVUFBVSxFQUNWRSxXQUFZLENBQ1YsQ0FDRUMsV0FBWSxLQUNaQyxTQUFVLENBQ1JMLGFBQWMsRUFDZEMsVUFBVSxFQUNWYSxVQUFVLElBR2QsQ0FDRVYsV0FBWSxJQUNaQyxTQUFVLENBQ1JMLGFBQWMsRUFDZEMsVUFBVSxFQUNWYSxVQUFVLE9BTXBCdEksRUFBRTBCLE1BQU1lLEtBQUssZUFBZUgsU0FBUyxjQUd2QytGLEVBQVF4RyxHQUFHLGVBQWdCLFNBQVNJLEVBQU91RSxFQUFPK0IsRUFBY0MsSUFNbEUsU0FBMEJDLEVBQVFELEdBQ2hDLElBQU1FLEVBQU8xSSxFQUFFeUksR0FBUWhHLEtBQUssZUFDdEIwQyxFQUFPbkYsRUFBRXlJLEdBQVFoRyxLQUFLLGVBQ3RCa0csRUFBTzNJLEVBQUV5SSxHQUFRaEcsS0FBSyxnQkFBZ0JPLE9BQ3RDNEYsRUFBVTVJLEVBQUV5SSxHQUFRaEcsS0FBSyw2QkFBNkJPLE9BQ3RENkYsRUFBY0QsRUFBVSxJQUFNRCxFQUNsQixJQUFkSCxHQUNGRSxFQUFLcEcsU0FBUyxZQUNkNkMsRUFBSzlELFlBQVksYUFFakJxSCxFQUFLckgsWUFBWSxZQUVmd0gsRUFDeUJGLEdBQXZCSCxFQUFZSSxHQUNkekQsRUFBSzdDLFNBQVMsWUFDZG9HLEVBQUtySCxZQUFZLGFBRWpCOEQsRUFBSzlELFlBQVksWUFHT3NILEVBQU8sRUFBN0JILEVBQVlJLEdBQ2R6RCxFQUFLN0MsU0FBUyxZQUNkb0csRUFBS3JILFlBQVksYUFFakI4RCxFQUFLOUQsWUFBWSxZQTdCbkJ5SCxDQUFnQjlJLEVBQUUwQixNQUFPOEciLCJmaWxlIjoic2NyaXB0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoZnVuY3Rpb24gKCkge1xuXG4gIGNvbnN0IHdyYXBwZXIgPSAkKCcud3JhcHBlcicpO1xuICBjb25zdCBib2R5ID0gJCgnYm9keScpO1xuICBjb25zdCBoZWFkZXJCb3R0b20gPSAkKCcuaGVhZGVyLWJvdHRvbSAud3JhcHBlci1pbm5lcicpO1xuICBjb25zdCBoZWFkZXJOYXYgPSAkKCcuaGVhZGVyLW5hdicpO1xuICBjb25zdCBoZWFkZXJDb250YWN0cyA9ICQoJy5oZWFkZXIgLmNvbnRhY3RzJyk7XG4gIGNvbnN0IGhlYWRlckFkZHJlc3MgPSAkKCcuaGVhZGVyIC5hZGRyZXNzLWhvdXJzJyk7XG4gIGNvbnN0IGhlYWRlclNlYXJjaCA9ICQoJy5oZWFkZXItc2VhcmNoJyk7XG4gIGNvbnN0IGhlYWRlckNhcnQgPSAkKCcuaGVhZGVyLWNhcnQnKTtcbiAgY29uc3QgZm9vdGVyU3Vic2NyaWJlID0gJCgnLmZvb3Rlci1zdWJzY3JpYmUnKTtcbiAgY29uc3QgZm9vdGVyQ29weXJpZ2h0cyA9ICQoJy5mb290ZXItY29weXJpZ2h0cycpO1xuICBjb25zdCBmb290ZXJTb2NpYWwgPSAkKCcuZm9vdGVyLXNvY2lhbCcpO1xuICBjb25zdCBjaG9vc2VyID0gJCgnLmNob29zZXInKTtcbiAgY29uc3QgY2hvb3NlckNvbG9yID0gJCgnLmNob29zZXIuY2hvb3Nlci1jb2xvcicpO1xuICBjb25zdCBjb2xvckl0ZW0gPSAkKCcuY29sb3ItbGlzdCBsaScpO1xuXG4gIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgIHdyYXBwZXIuYW5pbWF0ZSh7b3BhY2l0eTogMX0sIDUwMCk7XG4gIH0sIDUwMCk7XG5cbiAgcGFnZVJlcGFpbnQoKTtcblxuICBzZXRDb2xvcnMoKTtcblxuICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICBwYWdlUmVwYWludCgpO1xuICB9KTtcblxuICAkKCdbZGF0YS1yZW1vdmFibGUtY2xvc2VdJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICQodGhpcykucGFyZW50cygnW2RhdGEtcmVtb3ZhYmxlXScpXG4gICAgICAuZmFkZU91dCg0MDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS5kZXRhY2goKTtcbiAgICAgIH0pO1xuICB9KTtcblxuICAkKCcuaGVhZGVyLXNlYXJjaCBidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgZm9ybSA9ICQodGhpcykucGFyZW50cygnLmhlYWRlci1zZWFyY2gnKTtcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCAxMjAwKSB7XG4gICAgICBpZiAoZm9ybS5oYXNDbGFzcygnYWN0aXZlJykpIHtcbiAgICAgICAgZm9ybS5zdWJtaXQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm0uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3JtLnN1Ym1pdCgpO1xuICAgIH1cbiAgfSk7XG5cbiAgJCgnLmZpZWxkLXJhdGUtbGlzdCBpJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHZhbHVlID0gJCh0aGlzKS5pbmRleCgpICsgMTtcbiAgICAkKHRoaXMpLnBhcmVudHMoJy5maWVsZC1yYXRlJykuZmluZCgnaW5wdXRbdHlwZT1cImhpZGRlblwiXScpLnZhbCh2YWx1ZSk7XG4gICAgJCh0aGlzKS5wYXJlbnRzKCcuZmllbGQtcmF0ZS1saXN0JykuZmluZCgnaScpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7XG4gICAgICBpZiAoaW5kZXggPj0gdmFsdWUpIHtcbiAgICAgICAgJChlbGVtZW50KS5yZW1vdmVDbGFzcygnZmEtcmVkJykuYWRkQ2xhc3MoJ2ZhLWdyZXknKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQoZWxlbWVudCkucmVtb3ZlQ2xhc3MoJ2ZhLWdyZXknKS5hZGRDbGFzcygnZmEtcmVkJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gICQoJy5maWVsZC1maWxlIGlucHV0W3R5cGU9XCJmaWxlXCJdJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB2YWxBcnJheSA9ICQodGhpcykudmFsKCkuc3BsaXQoJ1xcXFwnKTtcbiAgICAkKHRoaXMpLnNpYmxpbmdzKCcuZmllbGQtZmlsZS10ZXh0JykudGV4dCh2YWxBcnJheVt2YWxBcnJheS5sZW5ndGggLSAxXSk7XG4gIH0pO1xuXG4gICQoJ2lucHV0W3R5cGU9XCJ0ZWxcIl0nKS5tYXNrKFwiKzcgKDk5OSkgOTk5LTk5OS05OVwiKTtcblxuICAkKCcuaGVhZGVyLWJ1cmdlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAkKHRoaXMpLnBhcmVudHMoJy5oZWFkZXInKS50b2dnbGVDbGFzcygnbWVudS1vcGVuZWQnKTtcbiAgfSk7XG5cbiAgJCgnW2RhdGEtY2FsbC1tb2RhbF0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gJCh0aGlzKS5hdHRyKCdkYXRhLWNhbGwtbW9kYWwnKTtcbiAgICBjb25zdCBzY3JvbGxWYWx1ZSA9ICQod2luZG93KS5zY3JvbGxUb3AoKTtcbiAgICBjb25zdCBtb2RhbCA9ICQoYFtkYXRhLW1vZGFsPVwiJHt0YXJnZXR9XCJdYCk7XG4gICAgYm9keS5hZGRDbGFzcygnbW9kYWwtb3BlbmVkJyk7XG4gICAgbW9kYWwuZmFkZUluKDMwMCkuY3NzKHtcbiAgICAgICdkaXNwbGF5JzogJ2ZsZXgnLFxuICAgICAgJ3RvcCc6IGAke3Njcm9sbFZhbHVlfXB4YFxuICAgIH0pO1xuICAgICQoZG9jdW1lbnQpLm9uKCd0b3VjaG1vdmUnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gICQoJy5tb2RhbCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGNvbnN0IHRhcmdldCA9ICQoZXZlbnQudGFyZ2V0KTtcbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdtb2RhbC1jbG9zZScpIHx8ICF0YXJnZXQuY2xvc2VzdCgnLm1vZGFsLWlubmVyJykubGVuZ3RoKSB7XG4gICAgICAkKHRoaXMpLmZhZGVPdXQoMzAwKTtcbiAgICAgIGJvZHkucmVtb3ZlQ2xhc3MoJ21vZGFsLW9wZW5lZCcpO1xuICAgICAgJChkb2N1bWVudCkub2ZmKCd0b3VjaG1vdmUnKTtcbiAgICB9XG4gIH0pO1xuXG4gICQoJ1tkYXRhLXNlbGVjdC1jb250cm9sXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJCh0aGlzKS5wYXJlbnRzKCdbZGF0YS1zZWxlY3RdJykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG4gICAgICAkKHRoaXMpLnBhcmVudHMoJ1tkYXRhLXNlbGVjdF0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJ1tkYXRhLXNlbGVjdF0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAkKHRoaXMpLnBhcmVudHMoJ1tkYXRhLXNlbGVjdF0nKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgfVxuICB9KTtcblxuICAkKCdbZGF0YS1zZWxlY3RdIHVsIGxpJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gJCh0aGlzKS50ZXh0KCk7XG4gICAgICAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICQodGhpcykuc2libGluZ3MoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAkKHRoaXMpLnBhcmVudHMoJ3VsJykuc2libGluZ3MoJ1tkYXRhLXNlbGVjdC1jb250cm9sXScpLnRleHQodmFsdWUpO1xuICAgICAgJCh0aGlzKS5wYXJlbnRzKCd1bCcpLnNpYmxpbmdzKCdpbnB1dCcpLnZhbCh2YWx1ZSk7XG4gICAgICAkKHRoaXMpLnBhcmVudHMoJ1tkYXRhLXNlbGVjdF0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgfVxuICB9KTtcblxuICAkKCcuYW1vdW50LWNob29zZXItY29udHJvbCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBhbW91bnRET00gPSAkKHRoaXMpLnNpYmxpbmdzKCdpbnB1dCcpO1xuICAgIGNvbnN0IGFtb3VudFZhbHVlID0gcGFyc2VJbnQoYW1vdW50RE9NLnZhbCgpKTtcbiAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnYW1vdW50LWNob29zZXItbWludXMnKSkge1xuICAgICAgaWYgKGFtb3VudFZhbHVlID4gMSkge1xuICAgICAgICBhbW91bnRET00udmFsKGFtb3VudFZhbHVlIC0gMSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdhbW91bnQtY2hvb3Nlci1wbHVzJykpIHtcbiAgICAgIGFtb3VudERPTS52YWwoYW1vdW50VmFsdWUgKyAxKTtcbiAgICB9XG4gICAgYW1vdW50RE9NLnRyaWdnZXIoJ2NoYW5nZScpO1xuICB9KTtcblxuICAkKCcuYW1vdW50LWNob29zZXIgaW5wdXQnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGNvc3RET00gPSAkKHRoaXMpLnBhcmVudHMoJy5hbW91bnQtY2hvb3NlcicpLnNpYmxpbmdzKCcuY2FyZC1jb3N0JykuY2hpbGRyZW4oJy5jYXJkLWNvc3QtdmFsdWUnKTtcbiAgICBjb25zdCBhbW91bnQgPSBwYXJzZUludCgkKHRoaXMpLnZhbCgpKTtcbiAgICBjb25zdCBpdGVtQ29zdCA9IHBhcnNlSW50KCQodGhpcykucGFyZW50cygnLmFtb3VudC1jaG9vc2VyJykuYXR0cignZGF0YS1jb3N0JykpO1xuICAgIGNvc3RET00udGV4dChhbW91bnQgKiBpdGVtQ29zdCArICcg0YDRg9CxLicpO1xuICB9KTtcblxuICBjb2xvckl0ZW0ub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcbiAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgJCh0aGlzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICB9XG4gIH0pO1xuXG4gIGNob29zZXIuZmluZCgnLmNob29zZXItdmFsdWUnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCQodGhpcykuY2xvc2VzdCgnLmNhdGFsb2ctYnJhbmRzJykubGVuZ3RoICYmICQod2luZG93KS53aWR0aCgpID4gNzY3XG4gICAgICB8fCAkKHRoaXMpLmNsb3Nlc3QoJy5jaG9vc2VyLWNvbG9yJykubGVuZ3RoICYmICQod2luZG93KS53aWR0aCgpID4gNzY3KSB7XG4gICAgICBjb25zb2xlLmxvZygnaGVsbG8nKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCQodGhpcykucGFyZW50cygnLmNob29zZXInKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcbiAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuY2hvb3NlcicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNob29zZXIucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5jaG9vc2VyJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgY2hvb3Nlci5maW5kKCd1bCBsaScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoISQodGhpcykuaGFzQ2xhc3MoJ2FjdGl2ZScpICYmICQodGhpcykuY2xvc2VzdCgnLmNhdGFsb2ctYnJhbmRzJykubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9ICQodGhpcykuaHRtbCgpO1xuICAgICAgJCh0aGlzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgJCh0aGlzKS5wYXJlbnRzKCcuY2hvb3NlcicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgIGlmICgkKHRoaXMpLmNsb3Nlc3QoJy5jaG9vc2VyLWNvbG9yJykubGVuZ3RoKSB7XG4gICAgICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDc2OCkge1xuICAgICAgICAgICQodGhpcykucGFyZW50cygndWwnKS5zaWJsaW5ncygnLmNob29zZXItdmFsdWUnKS5odG1sKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICAkKHRoaXMpLnBhcmVudHMoJ3VsJykuc2libGluZ3MoJ2lucHV0JykudmFsKCQodGhpcykuZmluZCgnLmNob29zZXItY29sb3ItdGV4dCcpLnRleHQoKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkKHRoaXMpLnBhcmVudHMoJ3VsJykuc2libGluZ3MoJy5jaG9vc2VyLXZhbHVlJykuaHRtbCh2YWx1ZSk7XG4gICAgICAgICQodGhpcykucGFyZW50cygndWwnKS5zaWJsaW5ncygnaW5wdXQnKS52YWwodmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgY2hvb3NlckNvbG9yLmZpbmQoJ3VsIGxpJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoISQodGhpcykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9ICQodGhpcykuZmluZCgnLmNob29zZXItY29sb3ItdGV4dCcpLnRleHQoKTtcbiAgICAgICQodGhpcykucGFyZW50cygndWwnKS5zaWJsaW5ncygnaW5wdXQnKS52YWwodmFsdWUpO1xuICAgIH1cbiAgfSk7XG5cbiAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gJChldmVudC50YXJnZXQpO1xuXG4gICAgaWYgKHRhcmdldC5jbG9zZXN0KCdbZGF0YS1zZWxlY3RdJykubGVuZ3RoID09PSAwKSAkKCcuYWN0aXZlW2RhdGEtc2VsZWN0XScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5oZWFkZXItc2VhcmNoJykubGVuZ3RoID09PSAwKSAkKCcuaGVhZGVyLXNlYXJjaCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5jaG9vc2VyJykubGVuZ3RoID09PSAwKSBjaG9vc2VyLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICB9KTtcblxuICBmdW5jdGlvbiBwYWdlUmVwYWludCgpIHtcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCA3NjgpIHtcbiAgICAgIHJlbmRlck1vYmlsZUhlYWRlcigpO1xuICAgICAgcmVuZGVyTW9iaWxlRm9vdGVyKCk7XG4gICAgfSBlbHNlIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDEyMDApIHtcbiAgICAgIHJlbmRlclRhYmxldEhlYWRlcigpO1xuICAgICAgcmVuZGVyVGFibGV0Rm9vdGVyKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGhlYWRlclNlYXJjaC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAkKCcuaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ21lbnUtb3BlbmVkJyk7XG4gICAgICByZW5kZXJEZXNrdG9wSGVhZGVyKCk7XG4gICAgICByZW5kZXJEZXNrdG9wRm9vdGVyKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcmVuZGVyTW9iaWxlSGVhZGVyKCkge1xuICAgIGhlYWRlclNlYXJjaC5pbnNlcnRCZWZvcmUoaGVhZGVyQ2FydCk7XG4gICAgaGVhZGVyQ29udGFjdHMuYXBwZW5kVG8oaGVhZGVyTmF2KTtcbiAgICBoZWFkZXJBZGRyZXNzLmFwcGVuZFRvKGhlYWRlck5hdik7XG4gIH1cblxuICBmdW5jdGlvbiByZW5kZXJUYWJsZXRIZWFkZXIoKSB7XG4gICAgaGVhZGVyU2VhcmNoLmluc2VydEJlZm9yZShoZWFkZXJDYXJ0KTtcbiAgICBoZWFkZXJDb250YWN0cy5hcHBlbmRUbyhoZWFkZXJCb3R0b20pO1xuICAgIGhlYWRlckFkZHJlc3MuYXBwZW5kVG8oaGVhZGVyTmF2KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbmRlckRlc2t0b3BIZWFkZXIoKSB7XG4gICAgaGVhZGVyU2VhcmNoLmFwcGVuZFRvKGhlYWRlckJvdHRvbSk7XG4gICAgaGVhZGVyQ29udGFjdHMuYXBwZW5kVG8oaGVhZGVyQm90dG9tKTtcbiAgICBoZWFkZXJBZGRyZXNzLmFwcGVuZFRvKGhlYWRlckJvdHRvbSk7XG4gIH1cblxuICBmdW5jdGlvbiByZW5kZXJNb2JpbGVGb290ZXIoKSB7XG4gICAgZm9vdGVyU3Vic2NyaWJlLmluc2VydEFmdGVyKGZvb3RlckNvcHlyaWdodHMpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVuZGVyVGFibGV0Rm9vdGVyKCkge1xuICAgIGZvb3RlclN1YnNjcmliZS5pbnNlcnRCZWZvcmUoZm9vdGVyU29jaWFsKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbmRlckRlc2t0b3BGb290ZXIoKSB7XG4gICAgICBmb290ZXJTdWJzY3JpYmUuaW5zZXJ0QmVmb3JlKGZvb3RlclNvY2lhbCk7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRDb2xvcnMgKCkge1xuICAgIGNvbG9ySXRlbS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykuYXR0cignZGF0YS1iYWNrZ3JvdW5kJywgJCh0aGlzKS5jc3MoJ2JhY2tncm91bmQtY29sb3InKSk7XG4gICAgfSk7XG4gIH1cblxufSk7XG4iLCIkKGZ1bmN0aW9uICgpIHtcblxuICBjb25zdCBib2R5ID0gJCgnYm9keScpO1xuICBjb25zdCBjYXRhbG9nRmlsdGVyID0gJCgnLmNhdGFsb2ctZmlsdGVyJyk7XG4gIGNvbnN0IGNhdGFsb2dBcnRpY2xlcyA9ICQoJy5jYXRhbG9nLWFydGljbGVzJyk7XG4gIGNvbnN0IGNhdGFsb2dCYW5uZXIgPSAkKCcuY2F0YWxvZy1iYW5uZXInKTtcbiAgY29uc3QgYnJlYWRjcnVtYnMgPSAkKCcuYnJlYWRjcnVtYnMnKTtcbiAgY29uc3QgY2F0YWxvZ0FzaWRlID0gJCgnLmNhdGFsb2ctYXNpZGUnKTtcbiAgY29uc3QgZmlsdGVyQ29zdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXItY29zdCcpO1xuICBjb25zdCBmaWx0ZXJDb3N0SGFuZGxlcyA9W1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXItY29zdC1mcm9tJyksXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlci1jb3N0LXRvJylcbiAgXTtcblxuICBjYXRhbG9nUmVwYWludCgpO1xuXG4gIHNldENob29zZXJDb2xvcnMoKTtcblxuICBpZiAoZmlsdGVyQ29zdCkge1xuICAgIG5vVWlTbGlkZXIuY3JlYXRlKGZpbHRlckNvc3QsIHtcbiAgICAgIHN0YXJ0OiBbMTAwMCwgNTAwMF0sXG4gICAgICBzdGVwOiAxMDAsXG4gICAgICBtYXJnaW46IDEwMDAsXG4gICAgICBjb25uZWN0OiB0cnVlLFxuICAgICAgcmFuZ2U6IHtcbiAgICAgICAgJ21pbic6IDAsXG4gICAgICAgICdtYXgnOiA4MDAwXG4gICAgICB9XG4gICAgfSk7XG4gICAgZmlsdGVyQ29zdEhhbmRsZXMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCwgaW5kZXgpIHtcbiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBmaWx0ZXJDb3N0Lm5vVWlTbGlkZXIuc2V0SGFuZGxlKGluZGV4LCBmaWx0ZXJDb3N0SGFuZGxlc1tpbmRleF0udmFsdWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgZmlsdGVyQ29zdC5ub1VpU2xpZGVyLm9uKCd1cGRhdGUnLCBmdW5jdGlvbiAodmFsdWVzLCBoYW5kbGUpIHtcbiAgICAgIGZpbHRlckNvc3RIYW5kbGVzW2hhbmRsZV0udmFsdWUgPSBNYXRoLnRydW5jKHZhbHVlc1toYW5kbGVdKTtcbiAgICB9KTtcbiAgfVxuXG4gICQod2luZG93KS5vbigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgIGNhdGFsb2dSZXBhaW50KCk7XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIGNhdGFsb2dSZXBhaW50ICgpIHtcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCAxMjAwKSB7XG4gICAgICByZW5kZXJNb2JpbGVDYXRhbG9nKCk7XG4gICAgfSAgZWxzZSB7XG4gICAgICByZW5kZXJEZXNrdG9wQ2F0YWxvZygpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbmRlck1vYmlsZUNhdGFsb2cgKCkge1xuICAgIGJyZWFkY3J1bWJzLnByZXBlbmRUbygkKCcuaGVhZGVyJykubmV4dCgnLndyYXBwZXItaW5uZXInKSk7XG4gICAgaWYgKGNhdGFsb2dGaWx0ZXIuZmluZCgnLm1vZGFsLWNsb3NlJykubGVuZ3RoID09PSAwKSB7XG4gICAgICAkKCc8ZGl2IGNsYXNzPVwibW9kYWwtY2xvc2VcIj48L2Rpdj4nKS5wcmVwZW5kVG8oY2F0YWxvZ0ZpbHRlcik7XG4gICAgfVxuICAgIGNhdGFsb2dGaWx0ZXIuYXBwZW5kVG8oJy5tb2RhbFtkYXRhLW1vZGFsPVwiZmlsdGVyXCJdJyk7XG4gICAgY2F0YWxvZ0FydGljbGVzLmluc2VydEFmdGVyKCcucGFnaW5hdGlvbicpO1xuICAgIGNhdGFsb2dCYW5uZXIuaW5zZXJ0QWZ0ZXIoY2F0YWxvZ0FydGljbGVzKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbmRlckRlc2t0b3BDYXRhbG9nICgpIHtcbiAgICBicmVhZGNydW1icy5wcmVwZW5kVG8oJCgnLmNhdGFsb2ctY29udGVudCcpKTtcbiAgICBib2R5LnJlbW92ZUNsYXNzKCdtb2RhbC1vcGVuZWQnKTtcbiAgICAkKCcubW9kYWxbZGF0YS1tb2RhbD1cImZpbHRlclwiXScpLmNzcyh7XG4gICAgICAnZGlzcGxheSc6ICdub25lJyxcbiAgICAgICd0b3AnOiAnYXV0bydcbiAgICB9KTtcbiAgICBpZiAoY2F0YWxvZ0ZpbHRlci5maW5kKCcubW9kYWwtY2xvc2UnKS5sZW5ndGgpIHtcbiAgICAgICQoY2F0YWxvZ0ZpbHRlci5maW5kKCcubW9kYWwtY2xvc2UnKSkuZGV0YWNoKCk7XG4gICAgfVxuICAgIGNhdGFsb2dGaWx0ZXIucHJlcGVuZFRvKGNhdGFsb2dBc2lkZSk7XG4gICAgY2F0YWxvZ0FydGljbGVzLmFwcGVuZFRvKGNhdGFsb2dBc2lkZSk7XG4gICAgY2F0YWxvZ0Jhbm5lci5hcHBlbmRUbyhjYXRhbG9nQXNpZGUpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0Q2hvb3NlckNvbG9ycyAoKSB7XG4gICAgJCgnLmNob29zZXItY29sb3IgbGknKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykuYXR0cignZGF0YS1iYWNrZ3JvdW5kJywgJCh0aGlzKS5maW5kKCdzcGFuJykuZXEoMCkuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJykpO1xuICAgIH0pO1xuICB9XG5cbn0pOyIsIiQoZnVuY3Rpb24gKCkge1xuXG4gIGNvbnN0IGhlcm8gPSAkKCcuaGVybycpO1xuXG4gIGlmIChoZXJvLmxlbmd0aCkge1xuICAgIGhlcm8uc2xpY2soe1xuICAgICAgZG90czogdHJ1ZSxcbiAgICAgIGFycm93czogZmFsc2UsXG4gICAgICBmYWRlOiB0cnVlLFxuICAgICAgYXV0b3BsYXk6IHRydWUsXG4gICAgICBhdXRvcGxheVNwZWVkOiA1MDAwXG4gICAgfSk7XG4gIH1cblxufSk7XG4iLCIkKGZ1bmN0aW9uICgpIHtcblxuICBjb25zdCBpdGVtU2xpZGVyTGFyZ2UgPSAkKCcuaXRlbS1pbWFnZS1sYXJnZScpO1xuICBjb25zdCBpdGVtU2xpZGVyU21hbGwgPSAkKCcuaXRlbS1pbWFnZS1zbWFsbCcpO1xuICBjb25zdCBwYXJhbXMgPSAkKCcuaXRlbS1wYXJhbXMnKTtcbiAgY29uc3QgY29sb3JTbGlkZXIgPSAkKCcuY2hvb3Nlci5jaG9vc2VyLWNvbG9yIHVsJyk7XG4gIGNvbnN0IGl0ZW1MaXN0ID0gJCgnLml0ZW0gLml0ZW0tbGlzdCcpO1xuICBjb25zdCBpdGVtSW1hZ2UgPSAkKCcuaXRlbS1pbWFnZScpO1xuICBjb25zdCBpdGVtRm9ybUhlYWRlciA9ICQoJy5pdGVtLWZvcm0taGVhZGVyJyk7XG4gIGNvbnN0IGl0ZW1EZWxpdmVyeSA9ICQoJy5pdGVtLWRlbGl2ZXJ5Jyk7XG4gIGNvbnN0IGl0ZW1Gb3JtID0gJCgnLml0ZW0tZm9ybScpO1xuXG4gIGl0ZW1SZXBhaW50KCk7XG5cbiAgcmVwYWludENvbG9yU2xpZGVyKGNvbG9yU2xpZGVyKTtcblxuICBpZiAocGFyYW1zLmxlbmd0aCkge1xuICAgIHBhcmFtcy5zbGljayh7XG4gICAgICBzbGlkZXNUb1Nob3c6IDMsXG4gICAgICByZXNwb25zaXZlOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBicmVha3BvaW50OiAxMjAwLFxuICAgICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDRcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBicmVha3BvaW50OiA3NjgsXG4gICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgIHNsaWRlc1RvU2hvdzogMlxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0pO1xuICB9XG5cbiAgaWYgKGl0ZW1TbGlkZXJMYXJnZS5sZW5ndGggJiYgaXRlbVNsaWRlclNtYWxsLmxlbmd0aCkge1xuXG4gICAgaXRlbVNsaWRlckxhcmdlLnNsaWNrKHtcbiAgICAgIGFycm93czogZmFsc2UsXG4gICAgICBmYWRlOiB0cnVlLFxuICAgICAgYXNOYXZGb3I6ICcuaXRlbS1pbWFnZS1zbWFsbCdcbiAgICB9KTtcblxuICAgIGl0ZW1TbGlkZXJTbWFsbC5zbGljayh7XG4gICAgICBzbGlkZXNUb1Nob3c6IDQsXG4gICAgICBmb2N1c09uU2VsZWN0OiB0cnVlLFxuICAgICAgYXNOYXZGb3I6ICcuaXRlbS1pbWFnZS1sYXJnZScsXG4gICAgICByZXNwb25zaXZlOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBicmVha3BvaW50OiAxMjAwLFxuICAgICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9KTtcblxuICB9XG5cbiAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmVwYWludENvbG9yU2xpZGVyKGNvbG9yU2xpZGVyKTtcbiAgICBpdGVtUmVwYWludCgpO1xuICB9KTtcblxuICBmdW5jdGlvbiByZXBhaW50Q29sb3JTbGlkZXIoY29sb3JTbGlkZXIpIHtcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCA3NjgpIHtcbiAgICAgICQoY29sb3JTbGlkZXIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnc2xpY2stc2xpZGVyJykpIHtcbiAgICAgICAgICAkKHRoaXMpLnNsaWNrKCd1bnNsaWNrJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKGNvbG9yU2xpZGVyKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdzbGljay1zbGlkZXInKSkge1xuICAgICAgICAgICQodGhpcykuc2xpY2soe1xuICAgICAgICAgICAgc2xpZGVzVG9TaG93OiAzLFxuICAgICAgICAgICAgaW5maW5pdGU6IGZhbHNlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGl0ZW1SZXBhaW50KCkge1xuICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDc2OCkge1xuICAgICAgcmVuZGVyTW9iaWxlSXRlbSgpO1xuICAgIH0gZWxzZSBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCAxMjAwKSB7XG4gICAgICByZW5kZXJUYWJsZXRJdGVtKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlbmRlckRlc2t0b3BJdGVtKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcmVuZGVyTW9iaWxlSXRlbSAoKSB7XG4gICAgaXRlbUxpc3QuaW5zZXJ0QWZ0ZXIoaXRlbUZvcm1IZWFkZXIpO1xuICAgIGl0ZW1EZWxpdmVyeS5pbnNlcnRBZnRlcihpdGVtRm9ybSk7XG4gIH1cblxuICBmdW5jdGlvbiByZW5kZXJUYWJsZXRJdGVtICgpIHtcbiAgICBpdGVtTGlzdC5hcHBlbmRUbyhpdGVtSW1hZ2UpO1xuICAgIGl0ZW1EZWxpdmVyeS5pbnNlcnRBZnRlcihpdGVtRm9ybSk7XG4gIH1cblxuICBmdW5jdGlvbiByZW5kZXJEZXNrdG9wSXRlbSAoKSB7XG4gICAgaXRlbUxpc3QuYXBwZW5kVG8oaXRlbUltYWdlKTtcbiAgICBpdGVtRGVsaXZlcnkuYXBwZW5kVG8oaXRlbUZvcm0pO1xuICB9XG5cbiAgJCgnLml0ZW0tdGFiLWhlYWRlciBsaScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcbiAgICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDc2OCkge1xuICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5pdGVtLXRhYi1oZWFkZXInKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdGFiJyk7XG4gICAgICAkKCcuaXRlbS10YWItY29udGVudCA+IGxpJykuZmFkZU91dCgwKTtcbiAgICAgICQoJy5pdGVtLXRhYi1jb250ZW50JykuZmluZCgnbGlbZGF0YS10YWI9XCInICsgY3VycmVudCArICdcIl0nKS5mYWRlSW4oKTtcbiAgICAgICQodGhpcykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDc2OCkge1xuICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5pdGVtLXRhYi1oZWFkZXInKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICB9XG5cbiAgICB9XG4gIH0pO1xuXG4gICQoJy5pdGVtLWxpc3QtYWxsJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICQoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHtcbiAgICAgIHNjcm9sbFRvcDogJCgnLml0ZW0tdGFiLWNvbnRlbnQnKS5vZmZzZXQoKS50b3AgLSAxMjBcbiAgICB9LCA0MDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICQoJy5pdGVtLXRhYi1oZWFkZXIgbGlbZGF0YS10YWI9XCJwYXJhbXNcIl0nKVxuICAgICAgICAuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgJCgnLml0ZW0tdGFiLWNvbnRlbnQgbGlbZGF0YS10YWI9XCJwYXJhbXNcIl0nKVxuICAgICAgICAuZmFkZUluKCkuc2libGluZ3MoKS5mYWRlT3V0KDApO1xuICAgIH0pO1xuICB9KTtcblxufSk7IiwiJChmdW5jdGlvbiAoKSB7XG5cbiAgY29uc3QgbW9iaWxlU2xpZGVyID0gJCgnLmFkdmFudGFnZXMgdWwsIC5yZXZpZXdzLXJhdGUnKTtcblxuICByZXBhaW50TW9iaWxlU2xpZGVyKG1vYmlsZVNsaWRlcik7XG5cbiAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmVwYWludE1vYmlsZVNsaWRlcihtb2JpbGVTbGlkZXIpO1xuICB9KTtcblxuICBmdW5jdGlvbiByZXBhaW50TW9iaWxlU2xpZGVyKG1vYmlsZVNsaWRlcikge1xuICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDc2OCkge1xuICAgICAgJChtb2JpbGVTbGlkZXIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoISQodGhpcykuaGFzQ2xhc3MoJ3NsaWNrLXNsaWRlcicpKSB7XG4gICAgICAgICAgJCh0aGlzKS5zbGljaygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgJChtb2JpbGVTbGlkZXIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnc2xpY2stc2xpZGVyJykpIHtcbiAgICAgICAgICAkKHRoaXMpLnNsaWNrKCd1bnNsaWNrJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG59KTtcbiIsIiQoZnVuY3Rpb24gKCkge1xuXG4gIGNvbnN0IHJldmlld3NSZXN1bHRQZXJjZW50ID0gJCgnLnJldmlld3MtcmVzdWx0LXBlcmNlbnQnKTtcblxuICByZXZpZXdzUmVzdWx0UGVyY2VudC5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB2YWx1ZSA9IHBhcnNlSW50KCQodGhpcykuYXR0cignZGF0YS1yZXN1bHQtcGVyY2VudCcpKTtcbiAgICBjb25zdCB2YWx1ZURPTSA9ICQodGhpcykuZmluZCgnLnJldmlld3MtcmVzdWx0LXBlcmNlbnQtdmFsdWUnKTtcbiAgICAkKCc8ZGl2IGNsYXNzPVwicmV2aWV3cy1yZXN1bHQtcGVyY2VudC1jb2xvclwiPjwvZGl2PicpXG4gICAgICAuYXBwZW5kVG8odmFsdWVET00pLmNzcygnd2lkdGgnLCB2YWx1ZSArICclJyk7XG4gIH0pO1xuXG4gICQoJy5yZXZpZXdzLWxpc3QgLnJldmlld3MtY2FyZCBwIC5zaG93LWFsbCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAkKHRoaXMpLnNpYmxpbmdzKCcuYWxsLXRleHQnKS5jc3MoJ2Rpc3BsYXknLCAnaW5saW5lJyk7XG4gICAgJCh0aGlzKS5zaWJsaW5ncygnLmRvdHMnKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICQodGhpcykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgfSk7XG5cbn0pOyIsIiQoZnVuY3Rpb24gKCkge1xuXG4gIGNvbnN0IHNsaWRlcnMgPSAkKCcuY2VydGlmaWNhdGVzLWxpc3QsIC5wcm9kdWN0LWxpc3QsIC5hcnRpY2xlcy1saXN0LCAucmV2aWV3cy1zbGlkZXInKTtcblxuICBpZiAoc2xpZGVycy5sZW5ndGgpIHtcblxuICAgIHNsaWRlcnMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygncHJvZHVjdC1saXN0JykgfHwgJCh0aGlzKS5oYXNDbGFzcygnY2VydGlmaWNhdGVzLWxpc3QnKSkge1xuICAgICAgICAkKHRoaXMpLnNsaWNrKHtcbiAgICAgICAgICBzbGlkZXNUb1Nob3c6IDQsXG4gICAgICAgICAgaW5maW5pdGU6IGZhbHNlLFxuICAgICAgICAgIHJlc3BvbnNpdmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgYnJlYWtwb2ludDogMTIwMCxcbiAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDMsXG4gICAgICAgICAgICAgICAgaW5maW5pdGU6IGZhbHNlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDkzMCxcbiAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDIsXG4gICAgICAgICAgICAgICAgaW5maW5pdGU6IGZhbHNlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDc2OCxcbiAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICBpbmZpbml0ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDFcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkKHRoaXMpLnNsaWNrKHtcbiAgICAgICAgICBzbGlkZXNUb1Nob3c6IDIsXG4gICAgICAgICAgdmVydGljYWw6ZmFsc2UsXG4gICAgICAgICAgaW5maW5pdGU6IGZhbHNlLFxuICAgICAgICAgIHJlc3BvbnNpdmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgYnJlYWtwb2ludDogMTIwMCxcbiAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDIsXG4gICAgICAgICAgICAgICAgaW5maW5pdGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHZlcnRpY2FsOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDc2OCxcbiAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDEsXG4gICAgICAgICAgICAgICAgaW5maW5pdGU6IHRydWUsXG4gICAgICAgICAgICAgICAgdmVydGljYWw6IGZhbHNlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgJCh0aGlzKS5maW5kKCcuc2xpY2stcHJldicpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgIH0pO1xuXG4gICAgc2xpZGVycy5vbignYmVmb3JlQ2hhbmdlJywgZnVuY3Rpb24oZXZlbnQsIHNsaWNrLCBjdXJyZW50U2xpZGUsIG5leHRTbGlkZSkge1xuICAgICAgc2V0U2xpZGVyQXJyb3dzKCQodGhpcyksIG5leHRTbGlkZSk7XG4gICAgfSk7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHNldFNsaWRlckFycm93cyAoc2xpZGVyLCBuZXh0U2xpZGUpIHtcbiAgICBjb25zdCBwcmV2ID0gJChzbGlkZXIpLmZpbmQoJy5zbGljay1wcmV2Jyk7XG4gICAgY29uc3QgbmV4dCA9ICQoc2xpZGVyKS5maW5kKCcuc2xpY2stbmV4dCcpO1xuICAgIGNvbnN0IHNpemUgPSAkKHNsaWRlcikuZmluZCgnLnNsaWNrLXNsaWRlJykubGVuZ3RoO1xuICAgIGNvbnN0IHZpc2libGUgPSAkKHNsaWRlcikuZmluZCgnLnNsaWNrLXNsaWRlLnNsaWNrLWFjdGl2ZScpLmxlbmd0aDtcbiAgICBjb25zdCBzbWFsbEFtb3VudCA9IHZpc2libGUgKyAxID09PSBzaXplO1xuICAgIGlmIChuZXh0U2xpZGUgPT09IDApIHtcbiAgICAgIHByZXYuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICBuZXh0LnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcmV2LnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgIH1cbiAgICBpZiAoc21hbGxBbW91bnQpIHtcbiAgICAgIGlmIChuZXh0U2xpZGUgKyB2aXNpYmxlID49IHNpemUpIHtcbiAgICAgICAgbmV4dC5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgcHJldi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5leHQucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChuZXh0U2xpZGUgKyB2aXNpYmxlID4gc2l6ZSAtIDEpIHtcbiAgICAgICAgbmV4dC5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgcHJldi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5leHQucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbn0pO1xuIl19
